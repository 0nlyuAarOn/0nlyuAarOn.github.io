<!DOCTYPE html>
<html lang="en">

<!-- Head tag (contains Google-Analytics、Baidu-Tongji)-->
<head>
  <!-- Google Analytics -->
  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-124651948-1"></script>
    <script type="text/javascript">
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());

      gtag('config', 'UA-124651948-1');
    </script>
  

  <!-- Baidu Tongji -->
  

  <!-- Baidu Push -->
  
    <script>
      (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
      })();
    </script>
  

  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

  <meta name="google-site-verification" content="lxDfCplOZbIzjhG34NuQBgu2gdyRlAtMB4utP5AgEBc"/>
  <meta name="baidu-site-verification" content="PpzM9WxOJU"/>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="0nlyu‘blog"/>
  <meta name="keyword" content="终极目标: 吃, 喝 ,玩, 乐"/>
  <link rel="shortcut icon" href="/img/avatar/A.jpeg"/>

  <!-- Place this tag in your head or just before your close body tag. -->
  <script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script>

  
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/beantech.min.css"/>

    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css"/>
    <link rel="stylesheet" href="/css/widget.css"/>
    <link rel="stylesheet" href="/css/rocket.css"/>
    <link rel="stylesheet" href="/css/signature.css"/>
    <link rel="stylesheet" href="/css/catalog.css"/>
    <link rel="stylesheet" href="/css/livemylife.css"/>

    
      <!-- wave start -->
      <link rel="stylesheet" href="/css/wave.css"/>
      <!-- wave end -->
    

    
      <!-- top start (article top hot config) -->
      <link rel="stylesheet" href="/css/top.css"/>
      <!-- top end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/scroll.css"/>
      <!-- ThemeColor end -->
    

    
      <!-- viewer start (Picture preview) -->
      <link rel="stylesheet" href="/css/viewer.min.css"/>
      <!-- viewer end -->
    

    
      <!-- Search start -->
      <link rel="stylesheet" href="/css/search.css"/>
      <!-- Search end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/themecolor.css"/>
      <!-- ThemeColor end -->
    

    

    
      <!-- gitalk start -->
      <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"> -->
      <link rel="stylesheet" href="/css/gitalk.css"/>
      <!-- gitalk end -->
    
  

  <!-- Custom Fonts -->
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
  <!-- Hux change font-awesome CDN to qiniu -->
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Hux Delete, sad but pending in China <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'> <link
  href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/ css'> -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]-->

  <!-- ga & ba script hoook -->
  <link rel="canonical" href="http://yoursite-url/渗透测试/WEB应用漏洞简单总结/">
  <title>
    
      WEB应用漏洞简单总结 - 0nlyuAar0n|di.did.didi.di..
    
  </title>
<meta name="generator" content="Hexo 5.4.0"></head>


<!-- hack iOS CSS :active style -->

	<body ontouchstart="" class="body--light body--light">


		<!-- ThemeColor -->
		
		<!-- ThemeColor -->
<style type="text/css">
  .body--light {
    --light-mode: none;
    --dark-mode: block;
  }
  .body--dark {
    --light-mode: block;
    --dark-mode: none;
  }
  i.mdui-icon.material-icons.light-mode {
    display: var(--light-mode);
  }
  i.mdui-icon.material-icons.dark-mode {
    display: var(--dark-mode);
  }
</style>
<div class="toggle" onclick="document.body.classList.toggle('body--dark')">
  <i class="mdui-icon material-icons light-mode"></i>
  <i class="mdui-icon material-icons dark-mode"></i>
</div>
<script>
  //getCookieValue
  function getCookieValue(a) {
    var b = document.cookie.match('(^|[^;]+)\\s*' + a + '\\s*=\\s*([^;]+)');
    return b
      ? b.pop()
      : '';
  }
  let themeMode = 'light';
  if (getCookieValue('sb-color-mode') && (getCookieValue('sb-color-mode') !== themeMode)) {
    let dbody = document.body.classList;
    themeMode === 'dark' ? dbody.remove('body--dark') : dbody.add('body--dark');
  }

  //setCookieValue
  var toggleBtn = document.querySelector(".toggle");
  toggleBtn.addEventListener("click", function () {
    var e = document.body.classList.contains("body--dark");
    var cookieString = e
      ? "dark"
      : "light";
    var exp = new Date();
    exp.setTime(exp.getTime() + 3 * 24 * 60 * 60 * 1000); //3天过期
    document.cookie = "sb-color-mode=" + cookieString + ";expires=" + exp.toGMTString() + ";path=/";
  });
</script>

		

		<!-- Gitter -->
		

		<!-- Navigation (contains search)-->
		<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">奈何太菜...</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <!-- Known Issue, found by Hux: <nav>'s height woule be hold on by its content. so, when navbar scale out, the <nav> will cover tags. also mask any touch event of tags, unfortunately. -->
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="/">HOME</a>
          </li>

          
          
          
          
          <li>
            <a href="/archive/">
              
              ARCHIVES
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/categories/">
              
              CATEGORIES
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/tags/">
              
              TAGS
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/about/">
              
              ABOUT
              
              
            </a>
          </li>
          
          

          
          <li>
            <a class="popup-trigger">
              <span class="search-icon"></span>SEARCH</a>
          </li>
          

          <!-- LangSelect -->
          
        </ul>
      </div>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>
<!-- progress -->
<div id="progress">
  <div class="line" style="width: 0%;"></div>
</div>

<script>
  // Drop Bootstarp low-performance Navbar Use customize navbar with high-quality material design animation in high-perf jank-free CSS3 implementation
  var $body = document.body;
  var $toggle = document.querySelector('.navbar-toggle');
  var $navbar = document.querySelector('#huxblog_navbar');
  var $collapse = document.querySelector('.navbar-collapse');

  $toggle.addEventListener('click', handleMagic)

  function handleMagic(e) {
    if ($navbar.className.indexOf('in') > 0) {
      // CLOSE
      $navbar.className = " ";
      // wait until animation end.
      setTimeout(function() {
        // prevent frequently toggle
        if ($navbar.className.indexOf('in') < 0) {
          $collapse.style.height = "0px"
        }
      }, 400)
    } else {
      // OPEN
      $collapse.style.height = "auto"
      $navbar.className += " in";
    }
  }
</script>


		<!-- Post Header (contains intro-header、signature、wordcount、busuanzi、waveoverlay) -->
		<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->

  <style type="text/css">
    .body--light {
      /* intro-header */
      --intro-header-background-image-url-home: url('/img/header_img/GoFar.jpg');
      --intro-header-background-image-url-post: url('/img/header_img/PTES/pexels.jpeg');
      --intro-header-background-image-url-page: url('//img/header_img/PTES/pexels.jpeg');
    }
    .body--dark {
      --intro-header-background-image-url-home: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/img/header_img/GoFar.jpg');
      --intro-header-background-image-url-post: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/img/header_img/PTES/pexels.jpeg');
      --intro-header-background-image-url-page: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('//img/header_img/PTES/pexels.jpeg');
    }

    header.intro-header {
       /*post*/
        background-image: var(--intro-header-background-image-url-post);
        /* background-image: url('/img/header_img/PTES/pexels.jpeg'); */
      
    }

    
      #signature {/*signature*/
        background-image: url('/img/signature/white.png');
      }
    
  </style>





<header class="intro-header">
  <!-- Signature -->
  <div id="signature">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
          
          <div class="post-heading">
            <div class="tags">
              
              <a class="tag" href="/tags/#渗透测试" title="渗透测试">渗透测试</a>
              
              <a class="tag" href="/tags/#web漏洞" title="web漏洞">web漏洞</a>
              
            </div>
            <h1>WEB应用漏洞简单总结</h1>
            <h2 class="subheading"></h2>
            <span class="meta">
              Posted by 0nlyuAar0n on
              2021-08-09
            </span>


            
            <!-- WordCount start -->
            <div class="blank_box"></div>
            <span class="meta">
              Estimated Reading Time <span class="post-count">46</span> Minutes
            </span>
            <div class="blank_box"></div>
            <span class="meta">
              Words <span class="post-count">12.8k</span> In Total
            </span>
            <div class="blank_box"></div>
            <!-- WordCount end -->
            
            
            <!-- 不蒜子统计 start -->
            <span class="meta" id="busuanzi_container_page_pv">
              Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
            </span>
            <!-- 不蒜子统计 end -->
            


          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  <!-- waveoverlay start -->
  <div class="preview-overlay">
    <svg class="preview-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
      </defs>
      <g class="preview-parallax">
        <use xlink:href="#gentle-wave" x="48" y="0" fill=var(--gentle-wave1)></use>
        <use xlink:href="#gentle-wave" x="48" y="3" fill=var(--gentle-wave2)></use>
        <use xlink:href="#gentle-wave" x="48" y="5" fill=var(--gentle-wave3)></use>
        <use xlink:href="#gentle-wave" x="48" y="7" fill=var(--gentle-wave)></use>
      </g>
    </svg>
  </div>
  <!-- waveoverlay end -->
  

</header>



		<!-- Main Content (Post contains
	Pager、
	tip、
	socialshare、
	gitalk、gitment、disqus-comment、
	Catalog、
	Sidebar、
	Featured-Tags、
	Friends Blog、
	anchorjs、
	) -->
		<!-- Modify by Yu-Hsuan Yen -->
<!-- Post Content -->
<article>
  <div class="container">
    <div class="row">
      <!-- Post Container -->
      <div class="col-lg-8 col-lg-offset-1 col-md-10 col-md-offset-1 post-container">

        <h1>WEB应用漏洞简单总结</h1>
<h2 id="前言">前言</h2>
<p>终于开始写自己的文章，以己微薄之力来抒写，或多或少的，总有着不足 ，打算试着吸收网络中的信息，先从常见安全漏洞类型开始，从web安全——&gt;系统安全——&gt;中间件安全——&gt;移动安全，一周一章的坚持下去。由于某某原因，文章不定时发表，或许有天就沉淀下来好好抒写了，哈哈哈。本文给web应用漏洞定个框架，后续会不断补起相关漏洞的原理、挖掘场景、实战利用等，如有不足，请多指教。</p>
<p><img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/14-16284945376661.jpg" alt="14"></p>
<blockquote>
<p>如果自己就是潮水的一部分，怎么能看见潮流的方向呢？<br>
&gt;——Paul Graham《黑客与画家》</p>
</blockquote>
<p>先放两张渗透漏洞占比：</p>
<blockquote>
<p>2018之前情况</p>
</blockquote>
<p><img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1537260348892.png" alt="1537260348892"></p>
<blockquote>
<p>2020情况</p>
</blockquote>
<p><img src="http://www.h3c.com.cn/cn/res/202104/27/20210427_5730556_image004_1402992_30003_0.png" alt="img"></p>
<blockquote>
<p>OWSAP TOP10 对比情况</p>
</blockquote>
<p><img src="http://www.h3c.com.cn/cn/res/202104/27/20210427_5730558_image006_1402992_30003_0.png" alt="img"></p>
<p>在来张攻击面占比：</p>
<p><img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/20210427_5730555_image003_1402992_30003_0.png" alt="img"></p>
<p>由上图可以看出目前安全的主要问题。借此，以本文为记，简单记录下自己所了解的web应用漏洞。</p>
<blockquote>
<p>ps：图来源于网络</p>
</blockquote>
<h2 id="一、注入漏洞">一、注入漏洞</h2>
<h3 id="1-1-SQL注入漏洞">1.1 SQL注入漏洞</h3>
<h4 id="漏洞描述：">漏洞描述：</h4>
<p>SQL注入漏洞产生的原因：<br>
网站应用程序编写时，未对用户的操作输入进行合法性校验，既没有进行有效地特殊字符过滤，导致在网络与数据库的交互过程中，操作输入的数据库语句能在前台执行数据库操作，达到攻击目的。</p>
<h4 id="漏洞危害：">漏洞危害：</h4>
<ol>
<li>机密、业务等数据丢失、被窃取</li>
<li>核心业务数据被篡改</li>
<li>网页被篡改</li>
<li>主机可能会被完全接管。</li>
<li>进一步控制主机入侵内网，危害内网安全。</li>
</ol>
<h4 id="修复建议：">修复建议：</h4>
<h5 id="代码层">代码层</h5>
<ol>
<li>网页代码中对用户输入的数据进行严格过滤</li>
<li>使用安全的API</li>
<li>规范编码,字符集</li>
<li>服务器端在提交数据库进行SQL查询之前，对特殊字符进行过滤、转义、替换、删除。</li>
<li>对输入的特殊字符进行Escape转义处理</li>
<li>最佳防御：
<ul>
<li>采用SQL语句预编译和绑定变量，是防御SQL注入的最佳方法。</li>
</ul>
</li>
</ol>
<blockquote>
<p>原因：采用了PreparedStatement，就会将sql语句：“select id, no from user where id=?” 预先编译好，也就是SQL引擎会预先进行语法分析，产生语法树，生成执行计划，也就是说，后面你输入的参数，无论你输入的是什么，都不会影响该sql语句的 语法结构了，因为语法分析已经完成了，而语法分析主要是分析sql命令，比如 select ,from ,where ,and, or ,order by 等等。所以即使你后面输入了这些sql命令，也不会被当成sql命令来执行了，因为这些sql命令的执行， 必须先的通过语法分析，生成执行计划，既然语法分析已经完成，已经预编译过了，那么后面输入的参数，是绝对不可能作为sql命令来执行的，只会被当做字符串字面值参数，所以sql语句预编译可以防御sql注入。</p>
</blockquote>
<h5 id="设备层">设备层</h5>
<ol>
<li>部署web应用防火墙</li>
</ol>
<h5 id="数据库层">数据库层</h5>
<ol>
<li>对数据库操作进行监控。</li>
</ol>
<h5 id="其他防御方式：">其他防御方式：</h5>
<ol>
<li>正则过滤</li>
<li>使用白名单来规范化输入验证方法</li>
</ol>
<h3 id="1-2-XML实体注入（XXE）">1.2 XML实体注入（XXE）</h3>
<h4 id="漏洞描述：-2">漏洞描述：</h4>
<p>XML注入类似于SQL注入，XML文件一般用作传输和存储数据及配置的，当允许引用外部实体时，在修改或新增数据时，没有对用户可控数据做转义，直接输入或输出数据，都会导致XML注入漏洞。</p>
<h4 id="危害：">危害：</h4>
<p>通过构造恶意内容，可导致读取任意文件、执行系统命令、探测内网端口、攻击内网网站等危害</p>
<blockquote>
<p>**注意：**执行系统命令(安装expect扩展的PHP环境里才有)</p>
</blockquote>
<h4 id="漏洞产生原因：">漏洞产生原因：</h4>
<ol>
<li>允许引用外部实体</li>
<li>传输的数据包含了标签内容</li>
<li>修改数据时会覆盖缘由的标签</li>
</ol>
<h4 id="修复建议：-2">修复建议：</h4>
<ol>
<li>过滤用户提交的xml数据，对特殊字符进行转码<br>
<img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1537272707572.png" alt="1537272707572"></li>
<li>禁用开发语言提供的外部实体方法：</li>
</ol>
<p>PHP：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">libxml_disable_entity_loader(<span class="literal">true</span>);</span><br></pre></td></tr></table></figure>
<p>JAVA:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法一 </span></span><br><span class="line"><span class="comment">// 不允许DTDs (doctypes) ,几乎可以阻止所有的XML实体攻击 </span></span><br><span class="line">DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();</span><br><span class="line">dbf.setExpandEntityReferences(<span class="keyword">false</span>);   </span><br><span class="line"><span class="comment">// 方式二</span></span><br><span class="line"><span class="comment">// JAXB防止xxe</span></span><br><span class="line">JAXBContext context = JAXBContext.newInstance(klass);</span><br><span class="line"></span><br><span class="line">XMLInputFactory xif = XMLInputFactory.newFactory();</span><br><span class="line">xif.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, <span class="keyword">false</span>);</span><br><span class="line">xif.setProperty(XMLInputFactory.SUPPORT_DTD, <span class="keyword">true</span>);</span><br><span class="line">XMLStreamReader xsr = xif.createXMLStreamReader(<span class="keyword">new</span> StringReader(xml)); </span><br></pre></td></tr></table></figure>
<p>Python：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line">xmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure>
<h4 id="参考文献：">参考文献：</h4>
<ol>
<li>
<p>小试XML实体注入攻击</p>
<p><a target="_blank" rel="noopener" href="https://chybeta.github.io/2017/07/04/%E5%B0%8F%E8%AF%95XML%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/">https://chybeta.github.io/2017/07/04/小试XML实体注入攻击/</a></p>
</li>
<li>
<p>Web Hacking 101 中文版<br>
<a target="_blank" rel="noopener" href="https://wizardforcel.gitbooks.io/web-hacking-101/content/14.html">https://wizardforcel.gitbooks.io/web-hacking-101/content/14.html</a></p>
</li>
<li>
<p>OWASP XML防御备忘单</p>
<p><a target="_blank" rel="noopener" href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.md">https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.md</a></p>
</li>
</ol>
<h3 id="1-3-OS注入">1.3 OS注入</h3>
<h4 id="风险等级：高危">风险等级：高危</h4>
<h4 id="漏洞描述：-3">漏洞描述：</h4>
<p>网站应用程序在编写时未对用户提交至服务器的数据进行合法性校验，运行用户能够提交系统命令操作，会导致攻击者能控制整个服务器。</p>
<h4 id="漏洞危害">漏洞危害</h4>
<p>攻击者可以执行任意操作系统命令，进行恶意攻击</p>
<h4 id="修复建议：-3">修复建议：</h4>
<ol>
<li>禁止调用系统命令</li>
<li>通过输入检查，过滤用户输入。</li>
<li>根据需求进行编译转义。 在Linux/UNIX中，可将给定的字符串用单引号括起来，在windows中，可以将给定的字符用双引号括起来，使单引号中所有shell的特殊字符失去原来的意义。</li>
<li>不仅要在客户端过滤，也要在服务器端进行过滤。</li>
<li>要用最小权限去运行程序，不要给予程序多余的权限，最好只允许在特定的路径下运行，可以通过明确的路径运行命令。</li>
<li>在程序执行错误时不要显示与内部相关联的细节。</li>
<li>如果只允许运行有限的命令，使用白名单方式过滤。</li>
<li>对于需要运行命令的请求，尽可能减少外部数据的输入，比如，能传参数的就不要传命令行；web应用程 序，如果可以将一些数据保存在会话，就不要发给客户端。</li>
<li>如果存在下载文件，可以分配文件一个id号，通过id号来访问，而不通过文件名访问。如果允许输入文件名，就需要严格检查文件名的合法性，避免可能的命令注入。</li>
<li>在进程和操作系统之间强制实施严格边界的“监狱”或类似沙箱环境中运行代码。</li>
</ol>
<h3 id="1-4-SOAP注入漏洞">1.4 SOAP注入漏洞</h3>
<h4 id="风险等级：高危-2">风险等级：高危</h4>
<h4 id="漏洞描述：-4">漏洞描述：</h4>
<p>用户提交的数据直接插入到SOAP消息中，攻击者可以破坏消息的结构，从而实现SOAP注入。</p>
<h4 id="漏洞危害：-2">漏洞危害：</h4>
<p>攻击者可以改变应用程序的逻辑，修改数据。</p>
<h4 id="修复建议：-4">修复建议：</h4>
<p>在用户提交的数据被插入SOAP消息的实施边界进行过滤</p>
<h3 id="1-5-XPATH注入漏洞">1.5 XPATH注入漏洞</h3>
<h4 id="风险等级：高危-3">风险等级：高危</h4>
<h4 id="漏洞描述：-5">漏洞描述：</h4>
<p>网站使用XPath访问数据，响应用户提交的输入。如果用户的输入未经过过滤就插入到XPath的查询中，攻击者就可以通过控制查询语句来破坏应用程序，或者获取未授权访问的数据。</p>
<h4 id="漏洞危害：-3">漏洞危害：</h4>
<p>攻击者可以改变应用程序的逻辑，修改数据。</p>
<h4 id="修复建议：-5">修复建议：</h4>
<p>1.在网页代码中对用户输入的数据进行严格过滤；<br>
2.部署Web应用防火墙；</p>
<h3 id="1-6-SMTP注入漏洞">1.6 SMTP注入漏洞</h3>
<h4 id="风险等级：高危-4">风险等级：高危</h4>
<h4 id="漏洞描述：-6">漏洞描述：</h4>
<p>在电子邮件功能中，攻击者可在会话中注入任意SMTP命令，完全控制应用程序的消息。</p>
<h4 id="漏洞危害：-4">漏洞危害：</h4>
<p>1)篡改用户的邮件内容</p>
<h4 id="修复建议：-6">修复建议：</h4>
<p>1)在客户端代码中对用户输入的数据进行严格过滤；<br>
2)部署Web应用防火墙；</p>
<h3 id="1-7-LDAP注入漏洞">1.7 LDAP注入漏洞</h3>
<h4 id="风险等级：高危-5">风险等级：高危</h4>
<h4 id="漏洞描述：-7">漏洞描述：</h4>
<p>LDAP是一种轻量级目录访问协议，可以用来保存信息。如果在查询语句中插入恶意代码，可以修改返回的结果</p>
<h4 id="漏洞危害：-5">漏洞危害：</h4>
<p>1)机密数据被窃取；</p>
<h4 id="修复建议：-7">修复建议：</h4>
<p>1)在查询中对用户输入的数据进行严格过滤；<br>
2)部署Web应用防火墙；</p>
<h3 id="1-8-HTTP消息头注入漏洞">1.8 HTTP消息头注入漏洞</h3>
<h4 id="漏洞描述：-8">漏洞描述：</h4>
<p>用户控制的数据以不安全的方式插入到应用程序返回的HTTP消息头中，如果攻击者能够在消息头中注入换行符，就能在响应中插入其他HTTP消息头，并在响应主体中写入任意内容。</p>
<h4 id="漏洞检测：">漏洞检测：</h4>
<p>通过修改参数来判断是否存在漏洞。</p>
<h4 id="漏洞危害：-6">漏洞危害：</h4>
<p>利用HTTP消息头注入漏洞可以控制用户访问页面的返回结果,执行恶意代码。</p>
<h4 id="修复建议：-8">修复建议：</h4>
<p>1.不要把用户控制的输入插入到应用程序返回的HTTP消息头中;<br>
2.部署Web应用防火墙。<br>
2.1 在设置HTTP响应头的代码中，过滤回车换行（%0d%0a、%0D%0A)字符。<br>
2.2 不采用有漏洞版本的apache服务器，同时对参数做合法性校验以及长度限制，谨慎的根据用户所传入参数做http返回包的header设置。</p>
<h3 id="1-9-代码注入：">1.9 代码注入：</h3>
<h4 id="1-9-1-命令注入漏洞">1.9.1 命令注入漏洞</h4>
<h5 id="风险等级：高危-6">风险等级：高危</h5>
<h5 id="漏洞描述：-9">漏洞描述：</h5>
<p>命令执行漏洞是指代码未对用户可控参数做过滤，导致直接带入执行外部程序或系统命令实施攻击执行命令的代码中，对恶意构造的语句，可被用来执行任意命令。</p>
<h5 id="漏洞危害：-7">漏洞危害：</h5>
<p>黑客可在服务器上执行任意命令，写入后门，从而入侵服务器，获取服务器的管理员权限，危害巨大。</p>
<h5 id="修复建议：-9">修复建议：</h5>
<p>严格过滤用户输入的数据，禁止执行系统命令</p>
<h4 id="1-9-2-文件包含漏洞">1.9.2 文件包含漏洞</h4>
<h5 id="漏洞描述：-10">漏洞描述：</h5>
<p>文件包含漏洞多数情况出现在PHP中，当然jsp中也存在，文件包含分为本地包含与远程包含。</p>
<h5 id="漏洞危害：-8">漏洞危害：</h5>
<ol>
<li>绕过WAF上传木马文件</li>
<li>加载有害的远程内容，影响程序运行。</li>
<li>读取敏感文件信息。</li>
</ol>
<h5 id="漏洞修复：">漏洞修复：</h5>
<ol>
<li>关闭allow_url_fopen</li>
<li>避免使用include参数</li>
<li>使用web检测文件内容</li>
</ol>
<h3 id="1-10-DDE-CSV-注入">1.10 DDE(CSV)注入</h3>
<h3 id="1-11-CRLF-注入">1.11 CRLF 注入</h3>
<h4 id="概念">概念</h4>
<p>CRLF 指的是<strong>回车符</strong>(<code>CR</code>，<code>ASCII 13</code>，<code>\r</code>，<code>%0d</code>) 和<strong>换行符</strong>(<code>LF</code>，<code>ASCII 10</code>，<code>\n</code>，<code>%0a</code>)。</p>
<h4 id="利用">利用</h4>
<p>攻击者控制HTTP 消息头中的字符，向请求行或首部中的字段注入一些恶意的CRLF，这样我们就能注入一些<code>会话首部字段（Cookie）</code>或<code>报文主体（HTML代码）</code>，所以CRLF Injection又叫<code>HTTP响应拆分漏洞（HTTP Response Splitting）</code>，简称HRS</p>
<p>一般用于组合漏洞或waf绕过执行payload，如 ssrf redis getshell、短信轰炸限制绕过、会话国定漏洞测试、浏览器filter xss绕过等。</p>
<p>检测思路：</p>
<p>抓包——&gt;在请求体url首部或其他头部中加入<code>%0a&#123;payload&#125;</code>，如<code>%0aSet-cookie:JSPSESSID%3Dhello</code>——&gt;响应返回信息中换行出现<code>&#123;payload&#125;</code>既存在。</p>
<h4 id="危害：-2">危害：</h4>
<ul>
<li>
<p>缓存污染，它是一种场景，攻击者可以修改缓冲中的条目，并托管恶意页面（即包含 JavaScript）而不是合理的页面。</p>
</li>
<li>
<p>防火墙绕过，它是一种场景，请求被构造，用于避免安全检查，通常涉及 CRLF 和过大的请求正文。</p>
</li>
<li>
<p>请求劫持：它是一种场景，攻击者恶意盗取 HTTPOnly 的 Cookie，以及 HTTP 验证信息。这类似于 XSS，但是不需要攻击者和客户端之间的交互。</p>
</li>
</ul>
<h4 id="修复">修复</h4>
<p>过滤 \r 、\n 之类的行结束符，避免输入的数据污染其他 HTTP 首部字段。</p>
<h2 id="二、请求伪造漏洞">二、请求伪造漏洞</h2>
<h3 id="2-1-SSRF">2.1  SSRF</h3>
<h4 id="简介">简介</h4>
<p>SSRF，Server-Side Request Forgery，服务端请求伪造，是一种由攻击者构造形成由服务器端发起请求的一个漏洞。一般情况下，SSRF 攻击的目标是从外网无法访问的内部系统。而根据请求后续处理逻辑不同，又分为回显型SSRF和非回显型SSRF，回显型SSRF就是将访问到的信息响应返回给攻击者，非回显型SSRF则不会，但可以通过DNS log或访问开放/非开放的端口导致的延时来判断。</p>
<h4 id="形成原因">形成原因</h4>
<p>由于服务端提供了从其他服务器应用获取数据的功能且没有对目标地址做过滤和限制。也就是说服务端能够对外发起网络请求的地方，都可能存在SSRF。如站点快照获取、收取邮箱邮件、文件处理、URL分享等。</p>
<h4 id="攻击原理">攻击原理</h4>
<p>通过控制功能中发起请求的服务来当做跳板机内网中其他服务。</p>
<h4 id="危害：-3">危害：</h4>
<ol>
<li>最大的危害就是网络穿透，根据业务环境判断深入程序。</li>
<li>对外网、服务器所在内网、本地进行端口扫描，获取服务banner信息</li>
<li>攻击内网或本地的应用程序，（如溢出、Redis Getshell、内网web漏洞等）</li>
<li>内外网端口发送payload攻击内网服务（如weblogic、jboss、stauts2、sqli等）</li>
<li>利用file、gopher、dict协议读取本地文件、执行命令等。</li>
<li>DOS攻击（请求大文件，一直保持keep-Alive Always)</li>
</ol>
<h4 id="出现的场景">出现的场景:</h4>
<ol>
<li>能够对外发起网络请求的地方，就可能存在 SSRF 漏洞</li>
<li>从远程服务器请求资源（Upload from URL，Import &amp; Export RSS Feed）</li>
<li>数据库内置功能（Oracle、MongoDB、MSSQL、Postgres、CouchDB、redis、memcache）</li>
<li>Webmail 收取其他邮箱邮件（POP3、IMAP、SMTP）</li>
<li>文件处理、编码处理、属性信息处理（ffmpeg、ImageMagic、DOCX、PDF、XML）</li>
<li>其他（https tls seesion）</li>
</ol>
<h4 id="SSRF漏洞的验证方法：">SSRF漏洞的验证方法：</h4>
<blockquote>
<p>1）通过抓包分析发送的请求是否是由服务器的发送的，从而来判断是否存在SSRF漏洞</p>
<p>2）在页面源码中查找访问的资源地址 ，如果该资源地址类型为 <a target="_blank" rel="noopener" href="http://www.baidu.com/xxx.php?image=%EF%BC%88%E5%9C%B0%E5%9D%80%EF%BC%89%E7%9A%84%E5%B0%B1%E5%8F%AF%E8%83%BD%E5%AD%98%E5%9C%A8SSRF%E6%BC%8F%E6%B4%9E">www.baidu.com/xxx.php?image=（地址）的就可能存在SSRF漏洞</a></p>
</blockquote>
<h4 id="开发语言应用">开发语言应用</h4>
<p>可利用协议:</p>
<ul>
<li>file://</li>
</ul>
<p>ssrf.php?url=file:///etc/password</p>
<ul>
<li>Dict://</li>
</ul>
<p>dict://<user-auth>@<host>:<port>/d:<word></word></port></host></user-auth></p>
<p>ssrf.php?url=dict://attacker:11111/</p>
<ul>
<li>SFTP://</li>
</ul>
<p>ssrf.php?url=sftp://example.com:11111/</p>
<ul>
<li>TFTP://</li>
</ul>
<p>ssrf.php?url=tftp://example.com:12346/TESTUDPPACKET</p>
<ul>
<li>LDAP://</li>
</ul>
<p>ssrf.php?url=ldap://localhost:11211/%0astats%0aquit</p>
<ul>
<li>Gopher://</li>
</ul>
<p>一般情况：</p>
<ul>
<li>dict探测端口</li>
<li>http获取指纹信息</li>
<li>file协议读取内网文件</li>
<li>Gopher打redis、fastcgi</li>
</ul>
<h5 id="PHP">PHP</h5>
<p>SSRF出现常见函数cURL、file_get_contents、fsockopen()等</p>
<blockquote>
<p>注：</p>
<ol>
<li>
<p>file_get_contents的gopher协议不能 UrlEncode</p>
</li>
<li>
<p>file_get_contents关于Gopher的302跳转有bug，导致利用失败</p>
</li>
<li>
<p>curl/libcurl 7.43上gopher协议存在bug（截断），除v7.49外，7.45以上无此bug</p>
</li>
<li>
<p>. curl_exec()默认不跟踪跳转</p>
</li>
<li>
<p>file_get_contents() 支持php://input协议</p>
</li>
</ol>
</blockquote>
<h5 id="python">python</h5>
<p>urllib(urllib2)和requests库</p>
<h5 id="JAVA">JAVA</h5>
<p>存在局限性，一般利用http协议来探测端口，利用file协议读取任意文件。常见的类中如HttpURLConnection，URLConnection，HttpClients中只支持sun.net.www.protocol里的所有协议:</p>
<p>http，https，file，ftp，mailto，jar，netdoc</p>
<blockquote>
<p>JDK 1.8 移除gopher协议</p>
<p>JDK  <code>1.7</code>，可以看到有 <code>gopher</code> <code>file</code> <code>ftp</code> <code>http</code> <code>https</code> <code>jar</code> <code>mailto</code> <code>netdoc</code> 八种协议</p>
</blockquote>
<h4 id="防御">防御</h4>
<p>常见的修复方案如下：</p>
<p><img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/81138e5f4403b0c5b7b1dc96bcd650ff.png" alt="img"></p>
<p>常规修复</p>
<ol>
<li>限制返回信息的，例如请求文件，只返回文件是否请求成功，没有请求成功到文件统一返回错误信息。</li>
<li>对请求地址设置白名单，只允许请求白名单内的地址。</li>
<li>禁用除http和https外的协议，如：file://，gopher://，dict://等</li>
<li>限制请求的端口为固定服务端口，如：80，443</li>
</ol>
<p>代码层:</p>
<ol>
<li>去除url中的特殊字符</li>
<li>判断是否属于内网ip</li>
<li>如果是域名的话，将url中的域名改为ip</li>
<li>请求的url为3中返回的url</li>
<li>请求时设置host header为ip</li>
<li>不跟随30x跳转（跟随跳转需要从1开始重新检测）</li>
</ol>
<h3 id="2-2-CSRF">2.2 CSRF</h3>
<p>跨站请求伪造，既CSRF，攻击者通过伪造来自受信任用户的请求，达到增加、删除、篡改网站内容的目的。</p>
<h4 id="CSRF与XSS的区别：">CSRF与XSS的区别：</h4>
<table>
<thead>
<tr>
<th style="text-align:left">XSS</th>
<th style="text-align:right">CSRF</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">XSS利用站点内的信任用户</td>
<td style="text-align:right">CSRF则通过伪装来自受信任用户的请求来利用受信任的网站</td>
</tr>
<tr>
<td style="text-align:left">需要获取Cookie</td>
<td style="text-align:right">不需要盗取cookie而是直接利用</td>
</tr>
<tr>
<td style="text-align:left">攻击者需要登录后台完成攻击。管理员可以看日志发现攻击者。‍‍‍‍</td>
<td style="text-align:right">攻击一直是管理员自己实现的，攻击者只负责了构造代码。‍</td>
</tr>
</tbody>
</table>
<p>XSS工作原理:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">攻击者发现XSS漏洞——构造代码——发送给受害人——受害人打开——攻击者获取受害人的cookie——完成攻击</span><br></pre></td></tr></table></figure>
<p>CSRF工作原理:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">攻击者发现CSRF漏洞——构造代码——发送给受害人——受害人打开——受害人执行代码——完成攻击</span><br></pre></td></tr></table></figure>
<h4 id="漏洞条件：">漏洞条件：</h4>
<ol>
<li>受害者必须R陆过网站（或者有权限）</li>
<li>攻击者（或黑客）提供恶意链接受害者必须打开</li>
<li>网站除了验证Cookie,没有特殊验证方法</li>
</ol>
<h4 id="漏洞危害：-9">漏洞危害：</h4>
<ol>
<li>攻击者冒充用户/管理员，伪造请求，进行篡改、转账、改密码、发邮件、购买商品等非法操作。</li>
<li>可能与xss漏洞结合，盗取cookie或者Token<br>
<img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1537261893429.png" alt="1537261893429"></li>
</ol>
<h4 id="修复建议：-10">修复建议：</h4>
<ol>
<li>过滤用户输入，不允许发布含有站内操作URL的连接</li>
<li>改良站内API的设计，关键操作使用验证码，只接受POST其你去，GET请求应该只浏览而不改变服务器端资源。</li>
<li>对于web站点，将持久化的授权方法（例如cookie或者HTTP授权）切换为瞬时的授权方法（在每个from中提供隐藏field）</li>
<li>在浏览其它站点前登出站点或者在浏览器会话结束后清理浏览器的cookie</li>
</ol>
<h4 id="服务端的防御：">服务端的防御：</h4>
<ol>
<li>验证HTTP Referer字段</li>
<li>请求地址中条件Token并验证（token不放在cookie中，放在http请求参数中，服务端对其进行验证）</li>
<li>将token加入http头属性中，避免了token出现在浏览器中，被泄露。</li>
</ol>
<h4 id="客户端防御：">客户端防御：</h4>
<p>为了配置服务端对token的验证，那么客户端在访问时也需要生成token，这是利用js来给html中的链接和表单请求地址附加csrftoken代码，其中已定义token为全局变量，其值可以从session中得到。<br>
跨站请求漏洞的危害与防御</p>
<h3 id="2-3-URL-Redirect漏洞（既URL重定向-跳转漏洞）">2.3 URL Redirect漏洞（既URL重定向/跳转漏洞）</h3>
<h5 id="漏洞背景：">漏洞背景：</h5>
<p>由于应用越来越多的需要和其他的第三方应用交互，以及在自身应用内部根据不同的逻辑将用户引向到不同的页面，譬如一个典型的登录接口就经常需要在认证成功之后将用户引导到登录之前的页面，整个过程中如果实现不好就可能导致一些安全问题，特定条件下可能引起严重的安全漏洞。</p>
<h5 id="漏洞原因：">漏洞原因：</h5>
<p>URL跳转漏洞是指后台服务器在告知浏览器跳转时，未对客户端传入的重定向地址进行合法性校验，导致用户浏览器跳转到钓鱼页面的一种漏洞。</p>
<p>对于URL跳转的实现一般会有几种实现方式：</p>
<ul>
<li>META标签内跳转</li>
<li>javascript跳转</li>
<li>header头跳转</li>
</ul>
<p><img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1537258732646.png" alt="153725 8732646"></p>
<h5 id="应用场景：">应用场景：</h5>
<p>常见于第三方授权登录功能，如QQ、百度、新浪等，可以在参数中传入Redirect_url地址时篡改成一个钓鱼恶意网址，就可以非法获取用户的授权信息。</p>
<p>有时也会用于突破长线的基于白名单方式的安全限制，如youku.com的视频，限制方式往往是检查URL是否是youku.com来实现，如果youku.com内含一个url跳转漏洞，将导致最终引入的资源属于不可信的第三方资源或者恶意站点，最终导致安全问题。</p>
<h5 id="漏洞危害：-10">漏洞危害：</h5>
<ol>
<li>web应用程序执行指向外部站点的重定向</li>
<li>攻击者可能会使用web服务器攻击其他站点，增加匿名性。</li>
</ol>
<h5 id="修复建议：-11">修复建议：</h5>
<p>理论上讲，url跳转属于CSRF的一种，我们需要对传入的URL做有效性的认证，保证该URL来自于正确的地方，限制的方式同防止csrf一样可以包括：</p>
<p><strong>代码层</strong></p>
<ol>
<li>在网页代码中需要对用户输入的数据进行严格过滤</li>
<li>服务端配置跳转白名单或域名白名单，只对合法的url做跳转</li>
<li>对请求参数做加密和签名，防止参数被篡改，服务端要能够合法解析url</li>
<li>referer的限制<br>
如果确定传递URL参数进入的来源，我们可以通过该方式实现安全限制，保证该URL的有效性，避免恶意用户自己生成跳转链接</li>
<li>加入有效性验证Token<br>
我们保证所有生成的链接都是来自于我们可信域的，通过在生成的链接里加入用户不可控的Token对生成的链接进行校验，可以避免用户生成自己的恶意链接从而被利用，但是如果功能本身要求比较开放，可能导致有一定的限制。</li>
</ol>
<p><strong>设备层</strong></p>
<ol>
<li>部署web应用防火墙</li>
</ol>
<h2 id="三、文件处理漏洞">三、文件处理漏洞</h2>
<h3 id="3-1-任意文件上传漏洞">3.1 任意文件上传漏洞</h3>
<p>网站存在任意文件上传漏洞，对文件上传功能没有进行格式限制，导致容易被黑客利用上传恶意脚本文件</p>
<h4 id="漏洞危害：-11">漏洞危害：</h4>
<ol>
<li>攻击者通过此漏洞上传恶意脚本文件，对服务器的正常运行造成安全威胁</li>
<li>攻击者可上传可执行的webshell（如php、jsp、asp类型的木马病毒），或者利用目录跳转上传gif、html、config文件，覆盖原有的系统文件，导致获取系统权限的目的。</li>
</ol>
<h4 id="修复建议：-12">修复建议：</h4>
<ol>
<li>对上传文件格式进行严格校验及安全扫描，防止上传恶意脚本文件；</li>
<li>设置权限限制，禁止上传目录的执行权限</li>
<li>严格限制可上传的文件类型</li>
<li>严格限制上传的文件路径</li>
<li>文件扩展名服务端白名单校验</li>
<li>文件内容服务端校验</li>
<li>上传文件重命名</li>
<li>隐藏上传文件路径</li>
</ol>
<h3 id="3-2-任意文件下载">3.2 任意文件下载</h3>
<h4 id="漏洞描述：-11">漏洞描述：</h4>
<p>一些网站由于业务需求，往往需要提供文件查看或文件下载功能，但若对用户查看或下载的文件不做限制，则恶意用户就能够查看或<br>
下载任意敏感文件，这就是文件查看与下载焉洞</p>
<h4 id="漏洞危害：-12">漏洞危害：</h4>
<ol>
<li>下载服务器任意文件，如脚本代码、服务及系统配置文件等，可用得到的代码进一步代码审计，得到更多可利用漏洞</li>
<li>可能存在被攻陷、恶意利用的敏感信息泄漏。</li>
<li>攻击者可构造恶意请求下载服务器上的敏感文件，进而植入网站后门控制网站服务器主机。</li>
</ol>
<h4 id="如何查找任意文件下载漏洞：">如何查找任意文件下载漏洞：</h4>
<ol>
<li>查找传入文件名的参数：<br>
2. 导入文件等参数，要是直接输入文件名，就有可能有注入点<br>
3. 常见问题参数名：<br>
RealPath,   FilePath ,  filepath ,  Path , path ,inputFile,   url,   urls ,  lang ,  dis,  data,  readfile, filep, src  menu,  META-INF , WEB-INF</li>
<li>代码中如何查找漏洞：<br>
3. PHP为例，常见问题代码：<br>
4. readfile<br>
5. fopen<br>
6. file_get_contents</li>
</ol>
<blockquote>
<p>常见敏感文件路径：</p>
<p>Windows：<br>
C:\boot.ini———— //查看系统版本<br>
C:\Windows\System32\inetsrv\MetaBase.xml———— //IIS配置文件<br>
C:\Windows\repair\sam ————//存储系统初次安装的密码<br>
C:\Program Files\mysql\my.ini           ————//Mysql配置文件<br>
C:\Program Files\mysql\data\mysql\use. MYD     ————//Mysql root<br>
C:\Windows\php.ini     ————//php配置信息<br>
C:\Windows\my.ini  ————//MySQL配置信息</p>
<p>Linux ：<br>
/root/.ssh/authorized_keys<br>
/root/.ssh/id_rsa<br>
/root/.ssh/id_ras.keystore<br>
/root/.ssh/known_hosts<br>
/etc/httpd/conf/httpd.conf<br>
/root/.bash_history<br>
/root/.mysql_history<br>
/proc/self/fd/fd[0-9]*( 文件标识符 )<br>
/proc/mounts<br>
/porc/config.gz<br>
/etc/passwd<br>
/etc/shadow<br>
/etc/my.cnf</p>
</blockquote>
<h4 id="修复建议：-13">修复建议：</h4>
<p>一般根据自身业务需要修改，常见修复方法如下：</p>
<ol>
<li>对文件下载进行过滤，过滤掉“ ./ ”、“ …/ ”、“ % ”等</li>
<li>对下载的文件路径进行严格控制，只允许下载某部分目录下的文件：</li>
<li>对下载文件后缀名做严格控制</li>
<li>升级您正在使用的 CMS 或插件至最新版本。</li>
<li>如果漏洞文件不再使用，请删除文件。<br>
注意：删除前请做好备份。</li>
</ol>
<h3 id="3-3-File-Operation-Web-xml漏洞">3.3 File Operation-Web.xml漏洞</h3>
<p>攻击者可以通过文件内容泄漏漏洞获取敏感文件的内容，或直接执行其指定的恶意脚本，进得Web服务器的控制权限。</p>
<h4 id="漏洞危害：-13">漏洞危害：</h4>
<ol>
<li>文件内容泄漏漏洞允许攻击者读取服务器中的任意文件，或通过特殊的指令将脚本源码文件的内容合并至当前的文件中执行。</li>
<li>很多脚本语言允许通过特殊的指令（如PHP 通过require关键字）将其他脚本源码文件的内容合并至当前的文件中执行，如果这些特殊的指令在包含的文件路径中含有用户提交的数据，则恶意攻击者就有可能通过构造特殊的数据将WEB服务器限制访问的文件内容（如操作系统或某些重要应用的配置文件）包含进来并通过浏览器获取其内容，这种方式通常称为本地文件包含；如果应用程序的配置还允许包含远程的其他服务器上的文件，恶意攻击者就有可能构造特殊的脚本然后通过包含并予以执行，进而获取WEB应用的敏感数据或控制权。</li>
</ol>
<h4 id="修复建议：-14">修复建议：</h4>
<ol>
<li>如果可能，使用包含指令时显式指定包含的文件名称；</li>
<li>如果必须通过用户的输入指定包含的文件，则最好分析用户的输入，然后从文件白名单中显式地选择；</li>
<li>请对用户的输入进行严格的过滤，确保其包含的文件在预定的目录中或不能包含URL参数。</li>
</ol>
<h3 id="3-4-Zip-Slip任意文件写漏洞">3.4 Zip Slip任意文件写漏洞</h3>
<h3 id="3-5-任意文件删除">3.5 任意文件删除</h3>
<h3 id></h3>
<h2 id="四、访问控制漏洞">四、访问控制漏洞</h2>
<h3 id="4-1-横向越权">4.1 横向越权</h3>
<h3 id="4-2-垂直越权">4.2 垂直越权</h3>
<h3 id="4-3-后台弱口令漏洞">4.3 后台弱口令漏洞</h3>
<p>网站管理后台用户名密码较为简单或为默认，易被黑客利用。</p>
<h4 id="漏洞危害：-14">漏洞危害：</h4>
<ol>
<li>攻击者利用弱口令登录网站管理后台，可任意增删文章等造成负面影响</li>
<li>攻击者可进一步查看网站信息，获取服务器权限，导致局域网(内网)被入侵。</li>
</ol>
<h4 id="修复建议：-15">修复建议：</h4>
<ol>
<li>对管理后台进行访问控制，修改后台弱口令，加强口令强度并定期修改。</li>
<li>增加验证机制，防爆破机制，限制ip＋cookie访问次数。</li>
</ol>
<h3 id="4-3-后台登陆页面绕过">4.3 后台登陆页面绕过</h3>
<p>由于一些开发语言的不安全配置导致越权操作（如vue认证界面、shiro绕过漏洞等），可直接通过访问后台地址进行访问，绕过登陆限制</p>
<h4 id="漏洞危害：-15">漏洞危害：</h4>
<ol>
<li>一旦入侵者发现后台url，便可进入后台页面，进行非法操作。</li>
</ol>
<h4 id="修复建议：-16">修复建议：</h4>
<ol>
<li>对后台所有url做好权限设置</li>
<li>禁止外网访问后台地址</li>
</ol>
<h3 id="4-4-验证机制缺陷漏洞">4.4 验证机制缺陷漏洞</h3>
<h4 id="风险等级：中危">风险等级：中危</h4>
<h4 id="漏洞描述：-12">漏洞描述：</h4>
<p>由于网站管理后台系统登录无验证码校验，可导致后台用户名密码被暴力破解。</p>
<h4 id="漏洞危害：-16">漏洞危害：</h4>
<p>1.攻击者可利用该漏洞无限次提交用户名密码，从而可以暴力破解后台用户名及密码；<br>
2.暴力破解后登录其中一个帐号可进管理后台，攻击者登录网站后台任意增删文章等造成负面影响；<br>
3.攻击者可进一步登陆后台查看网站信息、上传恶意脚本文件，获取服务器权限，导致局域网(内网)被入侵。</p>
<h4 id="修复建议：-17">修复建议：</h4>
<p>1.对该页面进行访问控制，禁止外网IP或非法IP访问后台页面，并增加验证码校验，加强帐号锁定机制。</p>
<h2 id="五、会话管理漏洞">五、会话管理漏洞</h2>
<h3 id="5-1-会话劫持">5.1 会话劫持</h3>
<h3 id="5-2-会话固定">5.2 会话固定</h3>
<h2 id="六、XSS漏洞">六、XSS漏洞</h2>
<p>XSS的漏洞主要成因是后端接收参数时未经过滤，导致参数改变了HTML的结构，可以在网站中插入任意代码，以获取网站管理员或者普通用户的cookie，隐藏运行网页木马，甚至获取浏览者主机操作权限，格式化浏览者的硬盘。</p>
<h3 id="危害：-4">危害：</h3>
<ol>
<li>可以劫持浏览器用户的会话</li>
<li>窃取客户端cookies</li>
<li>网络钓鱼。</li>
<li>强制弹出广告页面、刷流量等</li>
<li>网页挂马、隐藏运行网页木马</li>
<li>进行恶意操作，如任意篡改页面信息、删除文档等</li>
<li>进行大量的客户端攻击，比如DDOS攻击</li>
<li>获取客户端信息，例如用户的浏览历史、真实IP、开放端口等</li>
<li>获取浏览者主机操作权限，进一步渗透网站</li>
<li>传播跨站脚本蠕虫</li>
<li>结合其他漏洞，如CSRF漏洞，进一步作恶。</li>
</ol>
<h3 id="6-1-反射型XSS">6.1  反射型XSS</h3>
<p>只是简单地把用户输入的数据“反射”给浏览器，恶意JS代码会直接在受害者主机上的浏览器执行。但需要用户配合点击，才能利用，且只能执行一次，所以也叫“非持久性攻击”</p>
<h3 id="6-2-存储型XSS">6.2  存储型XSS</h3>
<p>会把用户输入的数据“存储”在服务器端，只要受害者浏览包含此恶意js代码的页面就会执行恶意代码，所以也叫“持久性xss”，常见留言板等可以提交展示用户输入内容的功能点。</p>
<h3 id="6-3-DOM-型XSS">6.3 DOM 型XSS</h3>
<p>通过修改页面的DOM节点形成xss漏洞。</p>
<h3 id="6-4-DOM-与反射型区别：">6.4 DOM 与反射型区别：</h3>
<p>反射型和存储型，都需要与服务端交互的，即服务端将提交的内容反馈到了html源码内，导致触发xss，也就是说返回到html源码中可以看到触发xss的代码</p>
<p>而DOM型不与服务端交互的，只与客户端上的JS交互，也就是说提交的恶意代码，被放到了JS中执行。</p>
<p><strong>根本区别： 输出点的不同。</strong></p>
<h3 id="6-4-修复建议">6.4 修复建议</h3>
<h4 id="6-4-1-设置httponly">6.4.1  设置httponly</h4>
<p>规定了不能使用js去获取cookie的内容，因此只能防御xss进行cookie劫持的问题。</p>
<p>Httponly是在set-cookie时标记的，可对单独某个参数标记也可对全部参数标记。</p>
<p>因为设置httponly的方法比较简单，使用也很灵活，并且对防御cookie劫持非常有用，因此已经渐渐成为一种默认的标准。</p>
<h4 id="6-4-2-输入点检查：">6.4.2 输入点检查：</h4>
<p>输入的数据进行合法性检查：</p>
<h5 id="1-使用xss-filter-与编译转义">1. 使用xss  filter 与编译转义</h5>
<p>XSS filter是一个文本文件，里面包含了允许被用户输入提交的字符（也包含不允许用户提交的字符）。</p>
<p><strong>在用户输入的时候， 设置白名单与黑名单（推荐使用白名单），过滤敏感字符，结合编译转义，避免被浏览器当成JS代码执行。</strong></p>
<p>XSS filter方式 配置编码，将一些敏感字符通过编码的方式改变原来的样子，避免被浏览器当成JS代码执行。编码方式如html编码、url、编码、16进制编码、javascript编码等。</p>
<h5 id="2-处理富文本">2. 处理富文本</h5>
<p>网页编辑器允许用户提交一些自定义的html代码，称为“富文本”。在富文本处防御xss漏洞，最简单有效的就是控制用户能使用的标签，限制为只能使用a、div等安全的标签。</p>
<ol start="2">
<li>针对特定的数据进行格式检查</li>
<li>针对输入点的检查最好放在服务器端实现。</li>
</ol>
<h4 id="6-4-3-输出点检查：">6.4.3 输出点检查：</h4>
<h5 id="1-对输入内容编码转义">1. 对输入内容编码转义</h5>
<h5 id="2-处理所有输出类型的XSS漏洞">2. 处理所有输出类型的XSS漏洞</h5>
<p>xss漏洞本质上是一种html注入，也就是将html代码注入到网页中。那么其防御的根本就是在将用户提交的代码显示到页面上时做好一系列的过滤与转义。</p>
<h4 id="6-4-4-其他：">6.4.4 其他：</h4>
<h5 id="1-开发者应该严格按照openid和openkey的校验规则判断openid和openkey是否合法，且判断其它参数的合法性，不合法不返回任何内容。">1. 开发者应该严格按照openid和openkey的校验规则判断openid和openkey是否合法，且判断其它参数的合法性，不合法不返回任何内容。</h5>
<h5 id="2-严格限制URL参数输入值的格式，不能包含不必要的特殊字符（-0d、-0a、-0D、-0A等）">2. 严格限制URL参数输入值的格式，不能包含不必要的特殊字符（%0d、%0a、%0D、%0A等）</h5>
<h2 id="七、安全配置错误">七、安全配置错误</h2>
<h3 id="7-1-数据库运行出错">7.1 数据库运行出错</h3>
<p>网站存在数据库运行出错，由于网页数据交互出错，攻击者可获取报错中的敏感信息。</p>
<h4 id="漏洞危害：-17">漏洞危害：</h4>
<ol>
<li>机密数据被窃取</li>
<li>攻击者通过构造特殊URL地址，触发系统web应用程序报错，在回显内容中，获取网站敏感信息。</li>
<li>攻击者利用泄露的敏感信息，获取网站服务器web路径，为进一步攻击利用提供帮助。</li>
</ol>
<h4 id="修复建议">修复建议</h4>
<ol>
<li>检查数据库缓存是否溢出，是否具有失效的配置管理、禁用一切不必要的功能。</li>
<li>对网站错误信息进行统一返回，模糊化处理。</li>
</ol>
<h3 id="7-2-Flash安全配置缺陷漏洞">7.2 Flash安全配置缺陷漏洞</h3>
<p>网站存在Flash安全配置缺陷，该漏洞可导致跨域访问，让用户访问非法Flash文件。</p>
<h3 id="7-3-敏感信息泄漏">7.3 敏感信息泄漏</h3>
<p>由于网站运维人员疏忽，存放敏感信息的文件被泄露或由于网站运行出错导致敏感信息泄露，以及不对登录认证的敏感信息进行加密，敏感信息以明文形式进行传输，导致易被攻击者利用</p>
<p><strong>一张图道出这个漏洞的危害情况</strong></p>
<p><img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1537260560525.png" alt="1537260560525"></p>
<h4 id="漏洞危害：-18">漏洞危害：</h4>
<ol>
<li>攻击者可直接下载用户的相关信息，包括网站的绝对路径、用户的登录名、密码、真实姓名、身份证号、电话号码、邮箱、QQ号等；</li>
<li>攻击者通过构造特殊URL地址，触发系统web应用程序报错，在回显内容中，获取网站敏感信息；</li>
<li>攻击者利用泄漏的敏感信息，获取网站服务器web路径，为进一步攻击提供帮助。</li>
<li>对未加密的敏感信息，攻击者可以直接窃取密钥、发起中间人攻击，或从服务器端窃取明文数据。</li>
<li>易造成用户敏感信息泄露与篡改。</li>
</ol>
<h4 id="修复建议：-18">修复建议：</h4>
<ol>
<li>对网站错误信息进行统一返回，模糊化处理</li>
<li>对存放敏感信息的文件进行加密并妥善储存，避免泄露敏感信息。</li>
<li>禁止缓存对包含敏感数据的响应</li>
<li>对传输过程中的敏感数据加密，且保证使用算法的安全，如使用加密连接SSL方式等。</li>
<li>对密码使用专用算法存储密码。</li>
<li>对于没必要存放的、重要的敏感数据，应当尽快清除，或者通过PCI DSS标记或拦截。未存储的数据不能被窃取。</li>
</ol>
<h3 id="7-4-ASP-net-错误事件">7.4 <a target="_blank" rel="noopener" href="http://ASP.net">ASP.net</a> 错误事件</h3>
<p>既Possible .Net Error Message</p>
<h4 id="漏洞等级：中危">漏洞等级：中危</h4>
<p>网站存在.net报错信息，由于网站未配置同一错误返回页面，导致aspx出错并显示出错误信息。</p>
<h4 id="漏洞危害-2">漏洞危害</h4>
<ol>
<li>攻击者可通过特殊的攻击向量，有可能泄露如绝对路径、源代码、sql语句等敏感信息，这些信息都有可能被进一步的利用攻击，造成更大的危害。</li>
</ol>
<h4 id="修复建议：-19">修复建议：</h4>
<ol>
<li>关闭PHP错误回显，或者修正代码。</li>
<li>在出错时，不要直接输出一条消息就完事，可重定向至一个专门的报错提示页面<br>
在显示用户输入数据时注意HtmlEncode</li>
</ol>
<h4 id="参考文献：-2">参考文献：</h4>
<p>针对IIS7以上的ASP.NET网站自定义错误页面与异常日志总结https://edi.wang/post/2014/1/11/iis7-aspnet-custom-error-best-practice</p>
<h3 id="7-5-PHP-错误事件">7.5 PHP 错误事件</h3>
<p>既Possible PHP Error Message<br>
网站存在Possible PHP Error Message，由于网站未配置统一错误返回页面，导致PHP出错并显示出错误信息。</p>
<h3 id="漏洞危害：-19">漏洞危害：</h3>
<ol>
<li>攻击者可通过特殊的攻击向量，有可能泄露如绝对路径、源代码、sql语句等敏感信息，这些信息都有可能被进一步的利用攻击，造成更大的危害</li>
</ol>
<h4 id="修复建议：-20">修复建议：</h4>
<ol>
<li>关闭PHP错误回显，或者修正代码。</li>
<li>在出错时，不要直接输出一条消息就完事，可重定向至一个专门的报错提示页面<br>
在显示用户输入数据时注意HtmlEncode</li>
</ol>
<h3 id="7-6-Application-error-message">7.6 Application error message</h3>
<p>信息泄漏是指因程序BUG，或者由于攻击者对程序的参数等输入接口进行填充非法的数据，使程序崩溃，输出一些调试信息以及源代码等数据。当攻击者得到此数据后，可以了解到很多隐私的敏感的数据，进而结合其他漏洞进行下一步的攻击。 信息泄漏分为多种泄漏方式，一般常见的为：<br>
1、物理路径泄漏<br>
当攻击者通过接口输入非法的数据时，应用程序出现错误，并返回网站物理路径。攻击者利用此信息，可通过本地文件包含漏洞直接拿到 webshell。<br>
2、程序使用版本泄漏<br>
通过传送大量的数据时，应用程序报错，并返回应用程序版本。攻击者利用此信息，查找官方漏洞文档，并利用现有expolit code实施攻击。<br>
3、源代码泄漏<br>
利用程序扩展名解析缺陷，访问隐藏的文件，并获取源代码。或者通过程序BUG，直接返回源代码，获取重要数据，进而实施下一步攻击。<br>
4、其他信息<br>
如返回所使用的第三方软件信息，比如程序使用了zend framework、数据库使用的 mysql 等。</p>
<h4 id="漏洞描述：-13">漏洞描述：</h4>
<p>这个漏洞是因为前台参数传到后台的时候属性没有对应上导致</p>
<h4 id="修复建议：-21">修复建议：</h4>
<p>1.该后台对应的实体中需要有各自属性的set/get方法。</p>
<p>2.将这两个属性放置到try…catch…语句中就行了。</p>
<p>3.如果还是不可以那就得前台代码对这两个属性进行验证，确保传递到后台参数的格式类型与后台的数据类型对的上。</p>
<h3 id="7-7-SVN源代码泄漏">7.7 SVN源代码泄漏</h3>
<p>由于目标网站没有及时清除SVN服务器连接时的残留信息，导致存在此漏洞</p>
<h4 id="漏洞危害：-20">漏洞危害：</h4>
<ol>
<li>攻击者可利用该漏洞下载网站的源代码，获取数据库的连接密码等敏感信息</li>
<li>攻击者可通过源代码分析出新的系统漏洞，从而进一步入侵系统。</li>
</ol>
<h4 id="修复建议：-22">修复建议：</h4>
<ol>
<li>删除指定SVN生成的各种文件，如&quot;/.svn/entries&quot;等</li>
</ol>
<h3 id="7-8-CVS信息泄漏">7.8 CVS信息泄漏</h3>
<p>由于目标网站没有及时清除CVS服务器连接连接时的残留信息，导致存在此漏洞。</p>
<h4 id="漏洞测试（借鉴）">漏洞测试（借鉴）</h4>
<p>访问／cvs/等页面，若出现下图内容，则表示存在此漏洞。</p>
<p><img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1537268446311.png" alt="1537268446311"><br>
前面是用户名 后面是服务器地址</p>
<h4 id="漏洞危害：-21">漏洞危害：</h4>
<ol>
<li>攻击者可利用该漏洞下载网站的源代码，获得数据库的连接密码等敏感信息。</li>
<li>攻击者可通过源代码分析出新的系统漏洞，从而进一步入侵系统。</li>
</ol>
<h4 id="修复建议-2">修复建议</h4>
<p>删除指定CVS生成的各种文件，如“/cvs/root”等。</p>
<h3 id="7-9-Elasticsearch未授权访问漏洞">7.9 Elasticsearch未授权访问漏洞</h3>
<h4 id="漏洞描述">漏洞描述</h4>
<p>elasticsearch 是一款java编写的企业级搜索服务，启动此服务默认会开放9200端口，可被非法操作数据。</p>
<h4 id="漏洞检测">漏洞检测</h4>
<p>检测：默认端口9200<br>
相当于一个API，任何人访问这个地址，就可以调用api，进行数据的增删改操作。</p>
<p><img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1537271566715.png" alt="1537271566715"></p>
<h4 id="漏洞危害-3">漏洞危害</h4>
<p>可被非法操作数据，对网站数据造成影响。</p>
<h4 id="修复方案">修复方案</h4>
<p>1.关闭9200端口<br>
2.防火墙上设置禁止外网访问此端口。</p>
<h3 id="7-10-crossdomain-xml配置不当漏洞">7.10 crossdomain.xml配置不当漏洞</h3>
<h4 id="漏洞描述：-14">漏洞描述：</h4>
<p>网站根目录下的文件crossdomain.xml指明了远程flash是否可以加载当前网站的资源（图片、网页内容、flash等）。<br>
如果配置不当，可能带来CSRF攻击。如下图所示：</p>
<p><img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1537271882897.png" alt="1537271882897"></p>
<h4 id="检查方法：">检查方法：</h4>
<p>访问http://[domain]/crossdomain.xml</p>
<h4 id="修复建议：-23">修复建议：</h4>
<p>对于不需要外部加载资源的网站，crossdomain.xml中更改<code>allow-access-from</code>的<code>domain</code>属性为域名白名单。<br>
修复大致样本参考如下（备注：示例中的<code>app10000.qzoneapp.com,app10000.imgcache.qzoneapp.com</code>请修改为自己指定的站点）：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?<span class="type">xml</span> version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;<span class="keyword">cross</span>-<span class="keyword">domain</span>-<span class="keyword">policy</span>&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure=&quot;false&quot; <span class="keyword">domain</span>=&quot;*.qq.com&quot;/&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure=&quot;false&quot; <span class="keyword">domain</span>=&quot;*.soso.com&quot;/&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure=&quot;false&quot; <span class="keyword">domain</span>=&quot;*.paipai.com&quot;/&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure=&quot;false&quot; <span class="keyword">domain</span>=&quot;*.gtimg.cn&quot;/&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure=&quot;false&quot; <span class="keyword">domain</span>=&quot;*.pengyou.com&quot;/&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure=&quot;false&quot; <span class="keyword">domain</span>=&quot;app10000.qzoneapp.com&quot;/&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure=&quot;false&quot; <span class="keyword">domain</span>=&quot;app10000.imgcache.qzoneapp.com&quot;/&gt;</span><br><span class="line">&lt;/<span class="keyword">cross</span>-<span class="keyword">domain</span>-<span class="keyword">policy</span>&gt;</span><br></pre></td></tr></table></figure>
<h2 id="八、其他">八、其他</h2>
<h3 id="8-1-目录遍历漏洞">8.1 目录遍历漏洞</h3>
<h4 id="风险等级：中危-2">风险等级：中危</h4>
<h4 id="漏洞描述-2">漏洞描述</h4>
<p>通过该漏洞可以获取系统文件及服务器的配置文件。利用服务器API、文件标准权限进行攻击。</p>
<h4 id="漏洞危害-4">漏洞危害</h4>
<ol>
<li>通过遍历、穷举等方式非法获取到文件目录结构</li>
<li>通过敏感目录下载敏感文件。</li>
<li>如果存在包含用户、密码、数据库等敏感信息，可能会导致管理后台登陆、数据库连接等危险操作。</li>
</ol>
<h4 id="修复建议-3">修复建议</h4>
<ol>
<li>修改配置文件，去除中间件（如IIS、Apache、tomcat）的文件目录索引功能</li>
<li>设置目录权限（禁止读写等）</li>
<li>在每个目录下创建一个空的index.html页面。</li>
</ol>
<h3 id="8-2-未过滤HTML代码漏洞">8.2 未过滤HTML代码漏洞</h3>
<p>由于页面未过滤HTML代码，攻击者可通过精心构造XSS代码（或绕过防火墙防护策略），实现跨站脚本攻击等。</p>
<h4 id="漏洞危害：-22">漏洞危害：</h4>
<ol>
<li>恶意用户可以使用JavaScript、VBScript、ActiveX、HTML语言甚至Flash利用应用的漏洞，从而获取其他用户信息；</li>
<li>攻击者能盗取会话cookie、获取账户、模拟其他用户身份，甚至可以修改网页呈现给其他用户的内容。</li>
</ol>
<h4 id="修复建议-4">修复建议</h4>
<ol>
<li>严格过滤用户输入的数据</li>
<li>参考跨站脚本漏洞修复方案。</li>
</ol>
<h3 id="8-3-FCK-编辑泄露漏洞">8.3 FCK 编辑泄露漏洞</h3>
<h4 id="漏洞描述-3">漏洞描述</h4>
<p>利用此漏洞攻击者可访问编辑器页面，上传图片</p>
<h4 id="漏洞危害-5">漏洞危害</h4>
<ol>
<li>由于网站编辑器没有对管理员登录进行校验，导致任意用户访问编辑器。</li>
<li>利用编辑器漏洞查看网站全硬盘目录</li>
</ol>
<h4 id="修复建议-5">修复建议</h4>
<p>对编辑器页面进行访问控制，禁止未授权访问，并升级FCK编辑版本。</p>
<h3 id="8-4-FCKeditor任意文件上传漏洞">8.4 FCKeditor任意文件上传漏洞</h3>
<p>FCKeditor版本低于或等于2.4.3时网站存在任意文件上传漏洞，可以利用该漏洞上传任意文件。</p>
<h4 id="漏洞危害-6">漏洞危害</h4>
<ol>
<li>由于目录网站未做上传格式的限制，导致网站、数据库和服务器有被入侵的风险。</li>
<li>可能导致网站被攻击者控制，网站数据被窃取、网页被篡改等。</li>
</ol>
<h4 id="修复建议-6">修复建议</h4>
<ol>
<li>设置FCKeditor编辑器相关页面在未授权的前提下无法正常访问，和限制FCK上传文件的格式。</li>
<li>下载并更新至FCKeditor的最新版本。</li>
</ol>
<h3 id="8-5-Unicode-编码转换漏洞">8.5 Unicode 编码转换漏洞</h3>
<h4 id="漏洞等级：中危-2">漏洞等级：中危</h4>
<p>该漏洞由于Unicode在编码转换过程中会忽略某些字符，导致攻击者可插入该字符绕过安全设备的检测。</p>
<p><img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1537262704972.png" alt="1537262704972"></p>
<h4 id="漏洞危害-7">漏洞危害</h4>
<ol>
<li>黑客可通过插入特殊字符，可拆分攻击的关键词，绕过安全设备的检测。</li>
<li>利用unicode编码转换绕过XSS过滤器</li>
</ol>
<h4 id="修复建议-7">修复建议</h4>
<ol>
<li>修改中间件，过滤特殊字符。</li>
<li>部署Web应用防火墙</li>
</ol>
<h3 id="8-6-发生内部错误">8.6 发生内部错误</h3>
<h4 id="漏洞描述：-15">漏洞描述：</h4>
<p>500 Internal Server Error。</p>
<h4 id="漏洞危害：-23">漏洞危害：</h4>
<p>攻击者向服务器提交精心构造的恶意数据后，有可能导致服务器出现内部错误、服务器宕机或数据库错乱。</p>
<h4 id="修复建议：-24">修复建议：</h4>
<ol>
<li>严格过滤用户输入的数据</li>
<li>服务器错误同一模糊处理，或者跳转到首页/404页面。</li>
</ol>
<h4 id="参考文献：-3">参考文献：</h4>
<p>内部服务器500错误(500 Internal server error)内部服务器500错误(500 Internal server error) 总结<br>
<a target="_blank" rel="noopener" href="http://blog.windigniter.com/2013/11/500-internal-server-error/">http://blog.windigniter.com/2013/11/500-internal-server-error/</a></p>
<h3 id="8-7-旁站攻击漏洞：">8.7 旁站攻击漏洞：</h3>
<p>多家网站在同一台服务器上，因一个网站存在致命高危漏洞，导致整台服务器被入侵。</p>
<h4 id="漏洞危害：-24">漏洞危害：</h4>
<ol>
<li>服务器上的所有网站均可被利用获取控制权限，从而达到网站任意增删改恶意操作、数据盗取等非法操作</li>
<li>攻击者可通过旁站服务器漏洞进入相应的内网，进一步内网渗透，拿下整个网络服务器。</li>
</ol>
<h4 id="修复建议：-25">修复建议：</h4>
<ol>
<li>修补同一台服务器上的其他网站漏洞</li>
<li>建议每个网站单独服务器运行。</li>
<li>定时对被引入网站的资源文件进行篡改检测，如果被篡改，则修正引入资源。</li>
</ol>
<h3 id="8-8-HPP漏洞：">8.8 HPP漏洞：</h3>
<p>即http参数污染，它是web容器处理http参数时的问题。<br>
比如访问URL:<a target="_blank" rel="noopener" href="http://www.xxx.com/index.php?str=hello%E6%AD%A4%E6%97%B6%EF%BC%8C%E9%A1%B5%E9%9D%A2%E6%98%BE%E7%A4%BAhello%E3%80%82%E4%BD%86%E5%A6%82%E6%9E%9C%E8%AE%BF%E9%97%AE:http://www.xxx.com/index.php?str=hello&amp;str=world&amp;str=nmask%E6%AD%A4%E6%97%B6%EF%BC%8C%E9%A1%B5%E9%9D%A2%E6%98%BE%E7%A4%BAnmask%EF%BC%8C%E6%8A%8A%E5%89%8D%E9%9D%A2%E5%8F%82%E6%95%B0%E7%9A%84%E5%80%BC%E7%BB%99%E8%A6%86%E7%9B%96%E4%BA%86%EF%BC%8C%E8%BF%99%E5%B0%B1%E6%98%AFhttp%E5%8F%82%E6%95%B0%E6%B1%A1%E6%9F%93%E3%80%82">http://www.xxx.com/index.php?str=hello此时，页面显示hello。但如果访问:http://www.xxx.com/index.php?str=hello&amp;str=world&amp;str=nmask此时，页面显示nmask，把前面参数的值给覆盖了，这就是http参数污染。</a></p>
<h4 id="漏洞危害：-25">漏洞危害：</h4>
<p>用来绕过WAF</p>
<h4 id="修复建议：-26">修复建议：</h4>
<p>1.修改web容器处理机制</p>
<h3 id="8-9-Git源代码泄露漏洞">8.9 Git源代码泄露漏洞</h3>
<h4 id="漏洞描述-4">漏洞描述</h4>
<p>服务器将.git文件放在了web目录下，导致可以访问git文件内容，获取源代码。</p>
<h4 id="漏洞验证">漏洞验证</h4>
<p>验证访问网站.git目录：</p>
<p><img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1537271678790.png" alt="1537271678790"><br>
可以看到git目录可以被访问，即存在此漏洞。</p>
<h4 id="漏洞危害-8">漏洞危害</h4>
<p>可以通过此漏洞，获取项目源代码。</p>
<h4 id="漏洞修复">漏洞修复</h4>
<p>1.删除网站目录下的.git文件<br>
2.中间件上设置.git目录访问权限，禁止访问<br>
3.防火墙上设置禁止访问此目录</p>
<h3 id="8-10-PHPInfo（）信息泄漏漏洞：">8.10 PHPInfo（）信息泄漏漏洞：</h3>
<h4 id="漏洞描述：-16">漏洞描述：</h4>
<p>Web站点的某些测试页面可能会使用到PHP的phpinfo()函数，会输出服务器的关键信息。如下图所示：</p>
<p><img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1537271767668.png" alt="1537271767668"></p>
<h4 id="检测方法：">检测方法：</h4>
<p>访问http://[ip]/test.php 以及http://[ip]/phpinfo.php看是否成功。</p>
<h4 id="修复方案：">修复方案：</h4>
<p>删除该PHP文件。</p>
<h3 id="8-9-短文件名泄漏漏洞">8.9 短文件名泄漏漏洞</h3>
<h4 id="漏洞等级：中危-3">漏洞等级：中危</h4>
<h4 id="漏洞描述：-17">漏洞描述：</h4>
<p>该漏洞由于Windows处理较长文件名时为方便，使用较短的文件名代替，攻击者可利用该漏洞尝试获取网站服务器下的文件名。</p>
<h4 id="漏洞危害：-26">漏洞危害：</h4>
<p>黑客可通过该漏洞尝试获取网站服务器下存放文件的文件名，达到获取更多信息来入侵服务器的目的。</p>
<h4 id="修复建议：-27">修复建议：</h4>
<ol>
<li>修改Windows配置，关闭短文件名功能。</li>
<li>部署Web应用防火墙，防止攻击者批量尝试。</li>
</ol>
<h2 id="附录一：-漏洞定级：">附录一： 漏洞定级：</h2>
<p>DREAD模型：<br>
<img src="/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/WEB%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/image-20210809203652273.png" alt="image-20210809203652273"></p>
<h3 id="DREAD模型，包括5个方面">DREAD模型，包括5个方面:</h3>
<p>DREAD模型5个方面<br>
a.危害性 （damage）：如果被攻击了，会造成怎样的危害<br>
b.持续生产 （reproducibility）：攻击后恢复运营的简易度？<br>
c.难度系数 （exploitability）： 实施此项攻击的难度是如何？<br>
d.受影响用户数 （affected users）： 有多少用户会受到此项攻击影响？<br>
e.发现系数 （discoverability）： 这项威胁是否容易被发现？</p>
<h3 id="如何计算漏洞等级：">如何计算漏洞等级：</h3>
<p>按照DREAD标准，计算给定威胁的值（1-3），结果范围为5-15.</p>
<blockquote>
<p>威胁值标准<br>
12-15的威胁值为高度危险<br>
8-11的威胁值为中度危险<br>
5-7的威胁值为帝都危险</p>
</blockquote>
<p>道哥的《白帽子讲web安全》给出了如下例子：<br>
a.网站登陆页面存在暴利破解：D(3)+ R(3) + E(3) + A(3) + D(3) = 15<br>
b.密码找回存在逻辑漏洞：D(3)+ R(3) + E(3) + A(3) + D(2) = 14<br>
c.密码可能被嗅探：D(3) + R(3) + E(3) + A(1) + D(3) = 13<br>
d.服务端脚本漏洞（如SQL等）: D(3) + R(3) + E(2) + A(3) + D(1) = 12<br>
e.钓鱼网站：D(3) + R(1) + E(3) + A(2) + D(3) = 12<br>
f.XSS或其他客户端威胁：D(3) + R(2) + E(2) + A(2) + D(2) = 11<br>
g.病毒或木马：D(3) + R(1) + E(2) + A(1) + D(1) = 8</p>
<h3 id="实践中">实践中</h3>
<p>实践中要将DREAD模型、企业核心业务、企业业务性质和漏洞本身的危害来梳理漏洞类型的默认等级。</p>
<h3 id="总结：">总结：</h3>
<h4 id="漏洞定级的三个维度：">漏洞定级的三个维度：</h4>
<p>漏洞影响、可利用性、受影响范围</p>
<h4 id="确定漏洞等级三个维度的综合评判计算公式：">确定漏洞等级三个维度的综合评判计算公式：</h4>
<p><strong>基础分值+漏洞影响分值+可利用性分值+受影响分值=最终漏洞等级</strong></p>
<h2 id="附录二：参考文献">附录二：参考文献</h2>
<ol>
<li>Vulnerability box<br>
<a target="_blank" rel="noopener" href="https://book.nmask.cn/">https://book.nmask.cn/</a></li>
<li>URL重定向/跳转漏洞<br>
<a target="_blank" rel="noopener" href="http://drops.xmd5.com/static/drops/papers-58.html">http://drops.xmd5.com/static/drops/papers-58.html</a></li>
<li>浅谈跨站脚本攻击与防御<br>
<a target="_blank" rel="noopener" href="https://thief.one/2017/05/31/1/">https://thief.one/2017/05/31/1/</a></li>
<li>国内外敏感信息泄露案例汇总分析<br>
<a target="_blank" rel="noopener" href="https://www.aqniu.com/industry/26957.html">https://www.aqniu.com/industry/26957.html</a></li>
<li>从零开始学CSRF<br>
<a target="_blank" rel="noopener" href="http://www.freebuf.com/articles/web/55965.html">http://www.freebuf.com/articles/web/55965.html</a></li>
<li>白帽子挖洞—跨站请求伪造（CSRF）篇http://www.freebuf.com/column/153543.html</li>
<li>骚姿势：当XSS与CSRF相遇<br>
<a target="_blank" rel="noopener" href="http://www.freebuf.com/column/184589.html">http://www.freebuf.com/column/184589.html</a></li>
<li>100件xss能做到的事情，你知道多少？<br>
<a target="_blank" rel="noopener" href="https://pockr.org/guest/activity?activity_no=act_017d460d4e5988dad2&amp;speech_no=sp_5b8b031ee65e0f6e41">https://pockr.org/guest/activity?activity_no=act_017d460d4e5988dad2&amp;speech_no=sp_5b8b031ee65e0f6e41</a></li>
<li>针对IIS7以上的ASP.NET网站自定义错误页面与异常日志总结https://edi.wang/post/2014/1/11/iis7-aspnet-custom-error-best-practice</li>
<li>内部服务器500错误(500 Internal server error)内部服务器500错误(500 Internal server error) 总结<br>
<a target="_blank" rel="noopener" href="http://blog.windigniter.com/2013/11/500-internal-server-error/">http://blog.windigniter.com/2013/11/500-internal-server-error/</a></li>
<li>分类：旁站攻击https://www.219.me/posts/category/security/%E6%94%BB%E9%98%B2%E5%AE%9E%E9%AA%8C%E5%AE%A4/%E6%97%81%E7%AB%99%E6%94%BB%E5%87%BB</li>
</ol>


        <hr>
        <!-- Pager -->
        <ul class="pager">
          
          <li class="previous">
            <a href="/Go/GOland教程/" data-toggle="tooltip" data-placement="top" title="GOland教程">&larr; Previous Post</a>
          </li>
          
          
          <li class="next">
            <a href="/Blog/Typore+hexo图片同步/" data-toggle="tooltip" data-placement="top" title="Typore+hexo图片同步">Next Post &rarr;</a>
          </li>
          
        </ul>

        
        <!-- tip start -->
        <!-- tip -->
<!-- tip start -->
<div class="tip">
  <p>
    
      -------------------------------------------------------------------------------- If you like this blog or find it useful for you, you are welcome to comment on it. You are also welcome to share this blog, so that more people can participate in it. If the images used in the blog infringe your copyright, please contact the author to delete them. Thank you !
    
  </p>
</div>
<!-- tip end -->

        <!-- tip end -->
        

        
        <!-- Sharing Srtart -->
        <!-- Social Social Share Post -->
<!-- Docs:https://github.com/overtrue/share.js -->

<div class="social-share" data-initialized="true" data-disabled="tencent ,douban ,qzone ,linkedin ,facebook ,google ,diandian" data-wechat-qrcode-helper="" align="center">
  <ul class="list-inline text-center social-share-ul">
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-twitter">
        <i class="fa fa-twitter fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a class="social-share-icon icon-wechat">
        <i class="fa fa-weixin fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-weibo">
        <i class="fa fa-weibo fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-qq">
        <i class="fa fa-qq fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon" href="mailto:?subject=WEB应用漏洞简单总结&body=Hi,I found this website and thought you might like it http://yoursite-url/渗透测试/WEB应用漏洞简单总结/">
        <i class="fa fa-envelope fa-1x" aria-hidden="true"></i>
      </a>
    </li>
  </ul>
</div>

<!-- css & js -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"> -->
<script defer="defer" async="true" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

        <!-- Sharing End -->
        
        <hr>

        <!-- comments start -->
        <!-- 1. gitalk comment -->

  <!-- gitalk start -->
  <!-- Docs:https://github.com/gitalk/gitalk/blob/master/readme-cn.md -->

  <div id="gitalk-container"></div>

  
    <!-- <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.js"></script> -->
    <script src="/js/comment/gitalk.js"></script>
  

  <script>
    var gitalk = new Gitalk({
      clientID: '6daf597fa0a20b7d167d',
      clientSecret: 'd7815897cdef77f24783de4c4023612fd330929d',
      repo: 'https://github.com/0nlyuAarOn/BloG_gitalk.git',
      owner: '0nlyuAar0n',
      admin: '[&#39;0nlyu&#39;]',
      id: 'Mon Aug 09 2021 15:31:24 GMT+0800', // Ensure uniqueness and length less than 50
      distractionFreeMode: false, // Facebook-like distraction free mode
      perPage: 10,
      pagerDirection: 'last',
      createIssueManually: false,
      language: 'en',
      proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token'
    });
    gitalk.render('gitalk-container');

    var gtFolded = () => {
      setTimeout(function () {
        let markdownBody = document.getElementsByClassName("markdown-body");
        let list = Array.from(markdownBody);
        list.forEach(item => {
          if (item.clientHeight > 250) {
            item.classList.add('gt-comment-body-folded');
            item.style.maxHeight = '250px';
            item.title = 'Click to Expand';
            item.onclick = function () {
              item.classList.remove('gt-comment-body-folded');
              item.style.maxHeight = '';
              item.title = '';
              item.onclick = null;
            };
          }
        })
      }, 800);
    }
  </script>

  <!-- gitalk end -->


<!-- 2. gitment comment -->


<!-- 3. disqus comment -->


        <!-- comments end -->
        <hr>

      </div>

      <!-- Catalog: Tabe of Content -->
      <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">WEB应用漏洞简单总结</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">前言</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%B8%80%E3%80%81%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.2.</span> <span class="toc-nav-text">一、注入漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-1-SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.2.1.</span> <span class="toc-nav-text">1.1 SQL注入漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A"><span class="toc-nav-number">1.2.1.1.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A"><span class="toc-nav-number">1.2.1.2.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A"><span class="toc-nav-number">1.2.1.3.</span> <span class="toc-nav-text">修复建议：</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%BB%A3%E7%A0%81%E5%B1%82"><span class="toc-nav-number">1.2.1.3.1.</span> <span class="toc-nav-text">代码层</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E8%AE%BE%E5%A4%87%E5%B1%82"><span class="toc-nav-number">1.2.1.3.2.</span> <span class="toc-nav-text">设备层</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B1%82"><span class="toc-nav-number">1.2.1.3.3.</span> <span class="toc-nav-text">数据库层</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%85%B6%E4%BB%96%E9%98%B2%E5%BE%A1%E6%96%B9%E5%BC%8F%EF%BC%9A"><span class="toc-nav-number">1.2.1.3.4.</span> <span class="toc-nav-text">其他防御方式：</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-2-XML%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%EF%BC%88XXE%EF%BC%89"><span class="toc-nav-number">1.2.2.</span> <span class="toc-nav-text">1.2 XML实体注入（XXE）</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-2"><span class="toc-nav-number">1.2.2.1.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%8D%B1%E5%AE%B3%EF%BC%9A"><span class="toc-nav-number">1.2.2.2.</span> <span class="toc-nav-text">危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0%EF%BC%9A"><span class="toc-nav-number">1.2.2.3.</span> <span class="toc-nav-text">漏洞产生原因：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-2"><span class="toc-nav-number">1.2.2.4.</span> <span class="toc-nav-text">修复建议：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%EF%BC%9A"><span class="toc-nav-number">1.2.2.5.</span> <span class="toc-nav-text">参考文献：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-3-OS%E6%B3%A8%E5%85%A5"><span class="toc-nav-number">1.2.3.</span> <span class="toc-nav-text">1.3 OS注入</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%A3%8E%E9%99%A9%E7%AD%89%E7%BA%A7%EF%BC%9A%E9%AB%98%E5%8D%B1"><span class="toc-nav-number">1.2.3.1.</span> <span class="toc-nav-text">风险等级：高危</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-3"><span class="toc-nav-number">1.2.3.2.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3"><span class="toc-nav-number">1.2.3.3.</span> <span class="toc-nav-text">漏洞危害</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-3"><span class="toc-nav-number">1.2.3.4.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-4-SOAP%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.2.4.</span> <span class="toc-nav-text">1.4 SOAP注入漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%A3%8E%E9%99%A9%E7%AD%89%E7%BA%A7%EF%BC%9A%E9%AB%98%E5%8D%B1-2"><span class="toc-nav-number">1.2.4.1.</span> <span class="toc-nav-text">风险等级：高危</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-4"><span class="toc-nav-number">1.2.4.2.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-2"><span class="toc-nav-number">1.2.4.3.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-4"><span class="toc-nav-number">1.2.4.4.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-5-XPATH%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.2.5.</span> <span class="toc-nav-text">1.5 XPATH注入漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%A3%8E%E9%99%A9%E7%AD%89%E7%BA%A7%EF%BC%9A%E9%AB%98%E5%8D%B1-3"><span class="toc-nav-number">1.2.5.1.</span> <span class="toc-nav-text">风险等级：高危</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-5"><span class="toc-nav-number">1.2.5.2.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-3"><span class="toc-nav-number">1.2.5.3.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-5"><span class="toc-nav-number">1.2.5.4.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-6-SMTP%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.2.6.</span> <span class="toc-nav-text">1.6 SMTP注入漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%A3%8E%E9%99%A9%E7%AD%89%E7%BA%A7%EF%BC%9A%E9%AB%98%E5%8D%B1-4"><span class="toc-nav-number">1.2.6.1.</span> <span class="toc-nav-text">风险等级：高危</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-6"><span class="toc-nav-number">1.2.6.2.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-4"><span class="toc-nav-number">1.2.6.3.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-6"><span class="toc-nav-number">1.2.6.4.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-7-LDAP%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.2.7.</span> <span class="toc-nav-text">1.7 LDAP注入漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%A3%8E%E9%99%A9%E7%AD%89%E7%BA%A7%EF%BC%9A%E9%AB%98%E5%8D%B1-5"><span class="toc-nav-number">1.2.7.1.</span> <span class="toc-nav-text">风险等级：高危</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-7"><span class="toc-nav-number">1.2.7.2.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-5"><span class="toc-nav-number">1.2.7.3.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-7"><span class="toc-nav-number">1.2.7.4.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-8-HTTP%E6%B6%88%E6%81%AF%E5%A4%B4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.2.8.</span> <span class="toc-nav-text">1.8 HTTP消息头注入漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-8"><span class="toc-nav-number">1.2.8.1.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B%EF%BC%9A"><span class="toc-nav-number">1.2.8.2.</span> <span class="toc-nav-text">漏洞检测：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-6"><span class="toc-nav-number">1.2.8.3.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-8"><span class="toc-nav-number">1.2.8.4.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-9-%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5%EF%BC%9A"><span class="toc-nav-number">1.2.9.</span> <span class="toc-nav-text">1.9 代码注入：</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#1-9-1-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.2.9.1.</span> <span class="toc-nav-text">1.9.1 命令注入漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E9%A3%8E%E9%99%A9%E7%AD%89%E7%BA%A7%EF%BC%9A%E9%AB%98%E5%8D%B1-6"><span class="toc-nav-number">1.2.9.1.1.</span> <span class="toc-nav-text">风险等级：高危</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-9"><span class="toc-nav-number">1.2.9.1.2.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-7"><span class="toc-nav-number">1.2.9.1.3.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-9"><span class="toc-nav-number">1.2.9.1.4.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#1-9-2-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.2.9.2.</span> <span class="toc-nav-text">1.9.2 文件包含漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-10"><span class="toc-nav-number">1.2.9.2.1.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-8"><span class="toc-nav-number">1.2.9.2.2.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D%EF%BC%9A"><span class="toc-nav-number">1.2.9.2.3.</span> <span class="toc-nav-text">漏洞修复：</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-10-DDE-CSV-%E6%B3%A8%E5%85%A5"><span class="toc-nav-number">1.2.10.</span> <span class="toc-nav-text">1.10 DDE(CSV)注入</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-11-CRLF-%E6%B3%A8%E5%85%A5"><span class="toc-nav-number">1.2.11.</span> <span class="toc-nav-text">1.11 CRLF 注入</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-nav-number">1.2.11.1.</span> <span class="toc-nav-text">概念</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%88%A9%E7%94%A8"><span class="toc-nav-number">1.2.11.2.</span> <span class="toc-nav-text">利用</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%8D%B1%E5%AE%B3%EF%BC%9A-2"><span class="toc-nav-number">1.2.11.3.</span> <span class="toc-nav-text">危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D"><span class="toc-nav-number">1.2.11.4.</span> <span class="toc-nav-text">修复</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%BA%8C%E3%80%81%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.3.</span> <span class="toc-nav-text">二、请求伪造漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-1-SSRF"><span class="toc-nav-number">1.3.1.</span> <span class="toc-nav-text">2.1  SSRF</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-nav-number">1.3.1.1.</span> <span class="toc-nav-text">简介</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%BD%A2%E6%88%90%E5%8E%9F%E5%9B%A0"><span class="toc-nav-number">1.3.1.2.</span> <span class="toc-nav-text">形成原因</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86"><span class="toc-nav-number">1.3.1.3.</span> <span class="toc-nav-text">攻击原理</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%8D%B1%E5%AE%B3%EF%BC%9A-3"><span class="toc-nav-number">1.3.1.4.</span> <span class="toc-nav-text">危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%87%BA%E7%8E%B0%E7%9A%84%E5%9C%BA%E6%99%AF"><span class="toc-nav-number">1.3.1.5.</span> <span class="toc-nav-text">出现的场景:</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#SSRF%E6%BC%8F%E6%B4%9E%E7%9A%84%E9%AA%8C%E8%AF%81%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-nav-number">1.3.1.6.</span> <span class="toc-nav-text">SSRF漏洞的验证方法：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80%E5%BA%94%E7%94%A8"><span class="toc-nav-number">1.3.1.7.</span> <span class="toc-nav-text">开发语言应用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#PHP"><span class="toc-nav-number">1.3.1.7.1.</span> <span class="toc-nav-text">PHP</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#python"><span class="toc-nav-number">1.3.1.7.2.</span> <span class="toc-nav-text">python</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#JAVA"><span class="toc-nav-number">1.3.1.7.3.</span> <span class="toc-nav-text">JAVA</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%98%B2%E5%BE%A1"><span class="toc-nav-number">1.3.1.8.</span> <span class="toc-nav-text">防御</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-2-CSRF"><span class="toc-nav-number">1.3.2.</span> <span class="toc-nav-text">2.2 CSRF</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#CSRF%E4%B8%8EXSS%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9A"><span class="toc-nav-number">1.3.2.1.</span> <span class="toc-nav-text">CSRF与XSS的区别：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%9D%A1%E4%BB%B6%EF%BC%9A"><span class="toc-nav-number">1.3.2.2.</span> <span class="toc-nav-text">漏洞条件：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-9"><span class="toc-nav-number">1.3.2.3.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-10"><span class="toc-nav-number">1.3.2.4.</span> <span class="toc-nav-text">修复建议：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%9A%84%E9%98%B2%E5%BE%A1%EF%BC%9A"><span class="toc-nav-number">1.3.2.5.</span> <span class="toc-nav-text">服务端的防御：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%98%B2%E5%BE%A1%EF%BC%9A"><span class="toc-nav-number">1.3.2.6.</span> <span class="toc-nav-text">客户端防御：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-3-URL-Redirect%E6%BC%8F%E6%B4%9E%EF%BC%88%E6%97%A2URL%E9%87%8D%E5%AE%9A%E5%90%91-%E8%B7%B3%E8%BD%AC%E6%BC%8F%E6%B4%9E%EF%BC%89"><span class="toc-nav-number">1.3.3.</span> <span class="toc-nav-text">2.3 URL Redirect漏洞（既URL重定向&#x2F;跳转漏洞）</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E8%83%8C%E6%99%AF%EF%BC%9A"><span class="toc-nav-number">1.3.3.0.1.</span> <span class="toc-nav-text">漏洞背景：</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E5%9B%A0%EF%BC%9A"><span class="toc-nav-number">1.3.3.0.2.</span> <span class="toc-nav-text">漏洞原因：</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%EF%BC%9A"><span class="toc-nav-number">1.3.3.0.3.</span> <span class="toc-nav-text">应用场景：</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-10"><span class="toc-nav-number">1.3.3.0.4.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-11"><span class="toc-nav-number">1.3.3.0.5.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%B8%89%E3%80%81%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.4.</span> <span class="toc-nav-text">三、文件处理漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-1-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.4.1.</span> <span class="toc-nav-text">3.1 任意文件上传漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-11"><span class="toc-nav-number">1.4.1.1.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-12"><span class="toc-nav-number">1.4.1.2.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-2-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-nav-number">1.4.2.</span> <span class="toc-nav-text">3.2 任意文件下载</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-11"><span class="toc-nav-number">1.4.2.1.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-12"><span class="toc-nav-number">1.4.2.2.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A6%82%E4%BD%95%E6%9F%A5%E6%89%BE%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E%EF%BC%9A"><span class="toc-nav-number">1.4.2.3.</span> <span class="toc-nav-text">如何查找任意文件下载漏洞：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-13"><span class="toc-nav-number">1.4.2.4.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-3-File-Operation-Web-xml%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.4.3.</span> <span class="toc-nav-text">3.3 File Operation-Web.xml漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-13"><span class="toc-nav-number">1.4.3.1.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-14"><span class="toc-nav-number">1.4.3.2.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-4-Zip-Slip%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.4.4.</span> <span class="toc-nav-text">3.4 Zip Slip任意文件写漏洞</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-5-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4"><span class="toc-nav-number">1.4.5.</span> <span class="toc-nav-text">3.5 任意文件删除</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link"><span class="toc-nav-number">1.4.6.</span> <span class="toc-nav-text"></span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%9B%9B%E3%80%81%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.5.</span> <span class="toc-nav-text">四、访问控制漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-1-%E6%A8%AA%E5%90%91%E8%B6%8A%E6%9D%83"><span class="toc-nav-number">1.5.1.</span> <span class="toc-nav-text">4.1 横向越权</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-2-%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83"><span class="toc-nav-number">1.5.2.</span> <span class="toc-nav-text">4.2 垂直越权</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-3-%E5%90%8E%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.5.3.</span> <span class="toc-nav-text">4.3 后台弱口令漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-14"><span class="toc-nav-number">1.5.3.1.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-15"><span class="toc-nav-number">1.5.3.2.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-3-%E5%90%8E%E5%8F%B0%E7%99%BB%E9%99%86%E9%A1%B5%E9%9D%A2%E7%BB%95%E8%BF%87"><span class="toc-nav-number">1.5.4.</span> <span class="toc-nav-text">4.3 后台登陆页面绕过</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-15"><span class="toc-nav-number">1.5.4.1.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-16"><span class="toc-nav-number">1.5.4.2.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-4-%E9%AA%8C%E8%AF%81%E6%9C%BA%E5%88%B6%E7%BC%BA%E9%99%B7%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.5.5.</span> <span class="toc-nav-text">4.4 验证机制缺陷漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%A3%8E%E9%99%A9%E7%AD%89%E7%BA%A7%EF%BC%9A%E4%B8%AD%E5%8D%B1"><span class="toc-nav-number">1.5.5.1.</span> <span class="toc-nav-text">风险等级：中危</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-12"><span class="toc-nav-number">1.5.5.2.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-16"><span class="toc-nav-number">1.5.5.3.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-17"><span class="toc-nav-number">1.5.5.4.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%BA%94%E3%80%81%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.6.</span> <span class="toc-nav-text">五、会话管理漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#5-1-%E4%BC%9A%E8%AF%9D%E5%8A%AB%E6%8C%81"><span class="toc-nav-number">1.6.1.</span> <span class="toc-nav-text">5.1 会话劫持</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#5-2-%E4%BC%9A%E8%AF%9D%E5%9B%BA%E5%AE%9A"><span class="toc-nav-number">1.6.2.</span> <span class="toc-nav-text">5.2 会话固定</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%85%AD%E3%80%81XSS%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.7.</span> <span class="toc-nav-text">六、XSS漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8D%B1%E5%AE%B3%EF%BC%9A-4"><span class="toc-nav-number">1.7.1.</span> <span class="toc-nav-text">危害：</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#6-1-%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="toc-nav-number">1.7.2.</span> <span class="toc-nav-text">6.1  反射型XSS</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#6-2-%E5%AD%98%E5%82%A8%E5%9E%8BXSS"><span class="toc-nav-number">1.7.3.</span> <span class="toc-nav-text">6.2  存储型XSS</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#6-3-DOM-%E5%9E%8BXSS"><span class="toc-nav-number">1.7.4.</span> <span class="toc-nav-text">6.3 DOM 型XSS</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#6-4-DOM-%E4%B8%8E%E5%8F%8D%E5%B0%84%E5%9E%8B%E5%8C%BA%E5%88%AB%EF%BC%9A"><span class="toc-nav-number">1.7.5.</span> <span class="toc-nav-text">6.4 DOM 与反射型区别：</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#6-4-%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE"><span class="toc-nav-number">1.7.6.</span> <span class="toc-nav-text">6.4 修复建议</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#6-4-1-%E8%AE%BE%E7%BD%AEhttponly"><span class="toc-nav-number">1.7.6.1.</span> <span class="toc-nav-text">6.4.1  设置httponly</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#6-4-2-%E8%BE%93%E5%85%A5%E7%82%B9%E6%A3%80%E6%9F%A5%EF%BC%9A"><span class="toc-nav-number">1.7.6.2.</span> <span class="toc-nav-text">6.4.2 输入点检查：</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#1-%E4%BD%BF%E7%94%A8xss-filter-%E4%B8%8E%E7%BC%96%E8%AF%91%E8%BD%AC%E4%B9%89"><span class="toc-nav-number">1.7.6.2.1.</span> <span class="toc-nav-text">1. 使用xss  filter 与编译转义</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#2-%E5%A4%84%E7%90%86%E5%AF%8C%E6%96%87%E6%9C%AC"><span class="toc-nav-number">1.7.6.2.2.</span> <span class="toc-nav-text">2. 处理富文本</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#6-4-3-%E8%BE%93%E5%87%BA%E7%82%B9%E6%A3%80%E6%9F%A5%EF%BC%9A"><span class="toc-nav-number">1.7.6.3.</span> <span class="toc-nav-text">6.4.3 输出点检查：</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#1-%E5%AF%B9%E8%BE%93%E5%85%A5%E5%86%85%E5%AE%B9%E7%BC%96%E7%A0%81%E8%BD%AC%E4%B9%89"><span class="toc-nav-number">1.7.6.3.1.</span> <span class="toc-nav-text">1. 对输入内容编码转义</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#2-%E5%A4%84%E7%90%86%E6%89%80%E6%9C%89%E8%BE%93%E5%87%BA%E7%B1%BB%E5%9E%8B%E7%9A%84XSS%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.7.6.3.2.</span> <span class="toc-nav-text">2. 处理所有输出类型的XSS漏洞</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#6-4-4-%E5%85%B6%E4%BB%96%EF%BC%9A"><span class="toc-nav-number">1.7.6.4.</span> <span class="toc-nav-text">6.4.4 其他：</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#1-%E5%BC%80%E5%8F%91%E8%80%85%E5%BA%94%E8%AF%A5%E4%B8%A5%E6%A0%BC%E6%8C%89%E7%85%A7openid%E5%92%8Copenkey%E7%9A%84%E6%A0%A1%E9%AA%8C%E8%A7%84%E5%88%99%E5%88%A4%E6%96%ADopenid%E5%92%8Copenkey%E6%98%AF%E5%90%A6%E5%90%88%E6%B3%95%EF%BC%8C%E4%B8%94%E5%88%A4%E6%96%AD%E5%85%B6%E5%AE%83%E5%8F%82%E6%95%B0%E7%9A%84%E5%90%88%E6%B3%95%E6%80%A7%EF%BC%8C%E4%B8%8D%E5%90%88%E6%B3%95%E4%B8%8D%E8%BF%94%E5%9B%9E%E4%BB%BB%E4%BD%95%E5%86%85%E5%AE%B9%E3%80%82"><span class="toc-nav-number">1.7.6.4.1.</span> <span class="toc-nav-text">1. 开发者应该严格按照openid和openkey的校验规则判断openid和openkey是否合法，且判断其它参数的合法性，不合法不返回任何内容。</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#2-%E4%B8%A5%E6%A0%BC%E9%99%90%E5%88%B6URL%E5%8F%82%E6%95%B0%E8%BE%93%E5%85%A5%E5%80%BC%E7%9A%84%E6%A0%BC%E5%BC%8F%EF%BC%8C%E4%B8%8D%E8%83%BD%E5%8C%85%E5%90%AB%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6%EF%BC%88-0d%E3%80%81-0a%E3%80%81-0D%E3%80%81-0A%E7%AD%89%EF%BC%89"><span class="toc-nav-number">1.7.6.4.2.</span> <span class="toc-nav-text">2. 严格限制URL参数输入值的格式，不能包含不必要的特殊字符（%0d、%0a、%0D、%0A等）</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%B8%83%E3%80%81%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF"><span class="toc-nav-number">1.8.</span> <span class="toc-nav-text">七、安全配置错误</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#7-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%90%E8%A1%8C%E5%87%BA%E9%94%99"><span class="toc-nav-number">1.8.1.</span> <span class="toc-nav-text">7.1 数据库运行出错</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-17"><span class="toc-nav-number">1.8.1.1.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE"><span class="toc-nav-number">1.8.1.2.</span> <span class="toc-nav-text">修复建议</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#7-2-Flash%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE%E7%BC%BA%E9%99%B7%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.8.2.</span> <span class="toc-nav-text">7.2 Flash安全配置缺陷漏洞</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#7-3-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F"><span class="toc-nav-number">1.8.3.</span> <span class="toc-nav-text">7.3 敏感信息泄漏</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-18"><span class="toc-nav-number">1.8.3.1.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-18"><span class="toc-nav-number">1.8.3.2.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#7-4-ASP-net-%E9%94%99%E8%AF%AF%E4%BA%8B%E4%BB%B6"><span class="toc-nav-number">1.8.4.</span> <span class="toc-nav-text">7.4 ASP.net 错误事件</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E7%AD%89%E7%BA%A7%EF%BC%9A%E4%B8%AD%E5%8D%B1"><span class="toc-nav-number">1.8.4.1.</span> <span class="toc-nav-text">漏洞等级：中危</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3-2"><span class="toc-nav-number">1.8.4.2.</span> <span class="toc-nav-text">漏洞危害</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-19"><span class="toc-nav-number">1.8.4.3.</span> <span class="toc-nav-text">修复建议：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%EF%BC%9A-2"><span class="toc-nav-number">1.8.4.4.</span> <span class="toc-nav-text">参考文献：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#7-5-PHP-%E9%94%99%E8%AF%AF%E4%BA%8B%E4%BB%B6"><span class="toc-nav-number">1.8.5.</span> <span class="toc-nav-text">7.5 PHP 错误事件</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-19"><span class="toc-nav-number">1.8.6.</span> <span class="toc-nav-text">漏洞危害：</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-20"><span class="toc-nav-number">1.8.6.1.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#7-6-Application-error-message"><span class="toc-nav-number">1.8.7.</span> <span class="toc-nav-text">7.6 Application error message</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-13"><span class="toc-nav-number">1.8.7.1.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-21"><span class="toc-nav-number">1.8.7.2.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#7-7-SVN%E6%BA%90%E4%BB%A3%E7%A0%81%E6%B3%84%E6%BC%8F"><span class="toc-nav-number">1.8.8.</span> <span class="toc-nav-text">7.7 SVN源代码泄漏</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-20"><span class="toc-nav-number">1.8.8.1.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-22"><span class="toc-nav-number">1.8.8.2.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#7-8-CVS%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F"><span class="toc-nav-number">1.8.9.</span> <span class="toc-nav-text">7.8 CVS信息泄漏</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%B5%8B%E8%AF%95%EF%BC%88%E5%80%9F%E9%89%B4%EF%BC%89"><span class="toc-nav-number">1.8.9.1.</span> <span class="toc-nav-text">漏洞测试（借鉴）</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-21"><span class="toc-nav-number">1.8.9.2.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE-2"><span class="toc-nav-number">1.8.9.3.</span> <span class="toc-nav-text">修复建议</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#7-9-Elasticsearch%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.8.10.</span> <span class="toc-nav-text">7.9 Elasticsearch未授权访问漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0"><span class="toc-nav-number">1.8.10.1.</span> <span class="toc-nav-text">漏洞描述</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B"><span class="toc-nav-number">1.8.10.2.</span> <span class="toc-nav-text">漏洞检测</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3-3"><span class="toc-nav-number">1.8.10.3.</span> <span class="toc-nav-text">漏洞危害</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88"><span class="toc-nav-number">1.8.10.4.</span> <span class="toc-nav-text">修复方案</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#7-10-crossdomain-xml%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%BD%93%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.8.11.</span> <span class="toc-nav-text">7.10 crossdomain.xml配置不当漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-14"><span class="toc-nav-number">1.8.11.1.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%A3%80%E6%9F%A5%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-nav-number">1.8.11.2.</span> <span class="toc-nav-text">检查方法：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-23"><span class="toc-nav-number">1.8.11.3.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%85%AB%E3%80%81%E5%85%B6%E4%BB%96"><span class="toc-nav-number">1.9.</span> <span class="toc-nav-text">八、其他</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-1-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.9.1.</span> <span class="toc-nav-text">8.1 目录遍历漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%A3%8E%E9%99%A9%E7%AD%89%E7%BA%A7%EF%BC%9A%E4%B8%AD%E5%8D%B1-2"><span class="toc-nav-number">1.9.1.1.</span> <span class="toc-nav-text">风险等级：中危</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-2"><span class="toc-nav-number">1.9.1.2.</span> <span class="toc-nav-text">漏洞描述</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3-4"><span class="toc-nav-number">1.9.1.3.</span> <span class="toc-nav-text">漏洞危害</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE-3"><span class="toc-nav-number">1.9.1.4.</span> <span class="toc-nav-text">修复建议</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-2-%E6%9C%AA%E8%BF%87%E6%BB%A4HTML%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.9.2.</span> <span class="toc-nav-text">8.2 未过滤HTML代码漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-22"><span class="toc-nav-number">1.9.2.1.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE-4"><span class="toc-nav-number">1.9.2.2.</span> <span class="toc-nav-text">修复建议</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-3-FCK-%E7%BC%96%E8%BE%91%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.9.3.</span> <span class="toc-nav-text">8.3 FCK 编辑泄露漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-3"><span class="toc-nav-number">1.9.3.1.</span> <span class="toc-nav-text">漏洞描述</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3-5"><span class="toc-nav-number">1.9.3.2.</span> <span class="toc-nav-text">漏洞危害</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE-5"><span class="toc-nav-number">1.9.3.3.</span> <span class="toc-nav-text">修复建议</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-4-FCKeditor%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.9.4.</span> <span class="toc-nav-text">8.4 FCKeditor任意文件上传漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3-6"><span class="toc-nav-number">1.9.4.1.</span> <span class="toc-nav-text">漏洞危害</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE-6"><span class="toc-nav-number">1.9.4.2.</span> <span class="toc-nav-text">修复建议</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-5-Unicode-%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.9.5.</span> <span class="toc-nav-text">8.5 Unicode 编码转换漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E7%AD%89%E7%BA%A7%EF%BC%9A%E4%B8%AD%E5%8D%B1-2"><span class="toc-nav-number">1.9.5.1.</span> <span class="toc-nav-text">漏洞等级：中危</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3-7"><span class="toc-nav-number">1.9.5.2.</span> <span class="toc-nav-text">漏洞危害</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE-7"><span class="toc-nav-number">1.9.5.3.</span> <span class="toc-nav-text">修复建议</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-6-%E5%8F%91%E7%94%9F%E5%86%85%E9%83%A8%E9%94%99%E8%AF%AF"><span class="toc-nav-number">1.9.6.</span> <span class="toc-nav-text">8.6 发生内部错误</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-15"><span class="toc-nav-number">1.9.6.1.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-23"><span class="toc-nav-number">1.9.6.2.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-24"><span class="toc-nav-number">1.9.6.3.</span> <span class="toc-nav-text">修复建议：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%EF%BC%9A-3"><span class="toc-nav-number">1.9.6.4.</span> <span class="toc-nav-text">参考文献：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-7-%E6%97%81%E7%AB%99%E6%94%BB%E5%87%BB%E6%BC%8F%E6%B4%9E%EF%BC%9A"><span class="toc-nav-number">1.9.7.</span> <span class="toc-nav-text">8.7 旁站攻击漏洞：</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-24"><span class="toc-nav-number">1.9.7.1.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-25"><span class="toc-nav-number">1.9.7.2.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-8-HPP%E6%BC%8F%E6%B4%9E%EF%BC%9A"><span class="toc-nav-number">1.9.8.</span> <span class="toc-nav-text">8.8 HPP漏洞：</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-25"><span class="toc-nav-number">1.9.8.1.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-26"><span class="toc-nav-number">1.9.8.2.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-9-Git%E6%BA%90%E4%BB%A3%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.9.9.</span> <span class="toc-nav-text">8.9 Git源代码泄露漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-4"><span class="toc-nav-number">1.9.9.1.</span> <span class="toc-nav-text">漏洞描述</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81"><span class="toc-nav-number">1.9.9.2.</span> <span class="toc-nav-text">漏洞验证</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3-8"><span class="toc-nav-number">1.9.9.3.</span> <span class="toc-nav-text">漏洞危害</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D"><span class="toc-nav-number">1.9.9.4.</span> <span class="toc-nav-text">漏洞修复</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-10-PHPInfo%EF%BC%88%EF%BC%89%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E%EF%BC%9A"><span class="toc-nav-number">1.9.10.</span> <span class="toc-nav-text">8.10 PHPInfo（）信息泄漏漏洞：</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-16"><span class="toc-nav-number">1.9.10.1.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%A3%80%E6%B5%8B%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-nav-number">1.9.10.2.</span> <span class="toc-nav-text">检测方法：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88%EF%BC%9A"><span class="toc-nav-number">1.9.10.3.</span> <span class="toc-nav-text">修复方案：</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#8-9-%E7%9F%AD%E6%96%87%E4%BB%B6%E5%90%8D%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E"><span class="toc-nav-number">1.9.11.</span> <span class="toc-nav-text">8.9 短文件名泄漏漏洞</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E7%AD%89%E7%BA%A7%EF%BC%9A%E4%B8%AD%E5%8D%B1-3"><span class="toc-nav-number">1.9.11.1.</span> <span class="toc-nav-text">漏洞等级：中危</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%EF%BC%9A-17"><span class="toc-nav-number">1.9.11.2.</span> <span class="toc-nav-text">漏洞描述：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3%EF%BC%9A-26"><span class="toc-nav-number">1.9.11.3.</span> <span class="toc-nav-text">漏洞危害：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE%EF%BC%9A-27"><span class="toc-nav-number">1.9.11.4.</span> <span class="toc-nav-text">修复建议：</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E9%99%84%E5%BD%95%E4%B8%80%EF%BC%9A-%E6%BC%8F%E6%B4%9E%E5%AE%9A%E7%BA%A7%EF%BC%9A"><span class="toc-nav-number">1.10.</span> <span class="toc-nav-text">附录一： 漏洞定级：</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#DREAD%E6%A8%A1%E5%9E%8B%EF%BC%8C%E5%8C%85%E6%8B%AC5%E4%B8%AA%E6%96%B9%E9%9D%A2"><span class="toc-nav-number">1.10.1.</span> <span class="toc-nav-text">DREAD模型，包括5个方面:</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97%E6%BC%8F%E6%B4%9E%E7%AD%89%E7%BA%A7%EF%BC%9A"><span class="toc-nav-number">1.10.2.</span> <span class="toc-nav-text">如何计算漏洞等级：</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%AE%9E%E8%B7%B5%E4%B8%AD"><span class="toc-nav-number">1.10.3.</span> <span class="toc-nav-text">实践中</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="toc-nav-number">1.10.4.</span> <span class="toc-nav-text">总结：</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%AE%9A%E7%BA%A7%E7%9A%84%E4%B8%89%E4%B8%AA%E7%BB%B4%E5%BA%A6%EF%BC%9A"><span class="toc-nav-number">1.10.4.1.</span> <span class="toc-nav-text">漏洞定级的三个维度：</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E7%A1%AE%E5%AE%9A%E6%BC%8F%E6%B4%9E%E7%AD%89%E7%BA%A7%E4%B8%89%E4%B8%AA%E7%BB%B4%E5%BA%A6%E7%9A%84%E7%BB%BC%E5%90%88%E8%AF%84%E5%88%A4%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F%EF%BC%9A"><span class="toc-nav-number">1.10.4.2.</span> <span class="toc-nav-text">确定漏洞等级三个维度的综合评判计算公式：</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E9%99%84%E5%BD%95%E4%BA%8C%EF%BC%9A%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-nav-number">1.11.</span> <span class="toc-nav-text">附录二：参考文献</span></a></li></ol></li></ol>
        
        </div>
      </aside>
    



      <!-- Sidebar Container -->
      <div class="
                col-lg-8 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

        <!-- Featured Tags -->
        
        <section>
          <!-- no hr -->
          <h5>
            <a href="/tags/">FEATURED TAGS</a>
          </h5>
          <div class="tags">
            
            <a class="tag" href="/tags/#渗透测试" title="渗透测试">渗透测试</a>
            
            <a class="tag" href="/tags/#web漏洞" title="web漏洞">web漏洞</a>
            
          </div>
        </section>
        

        <!-- Friends Blog -->
        
        <hr>
        <h5>FRIENDS</h5>
        <ul class="list-inline">

          
          <li>
            <a href="https://www.nhtcai.top/" target="_blank">0nlyuAar0n</a>
          </li>
          
          <li>
            <a href="https://www.nhtc.wiki/" target="_blank">奈何太菜</a>
          </li>
          
          <li>
            <a href="https://hexo.io/" target="_blank">Hexo</a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</article>



<!-- anchorjs start -->
<!-- async load function -->
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script type="text/javascript">
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function(e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  };
</script>
<script type="text/javascript">
  //anchor-js, Doc:http://bryanbraun.github.io/anchorjs/
  async ("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js", function() {
    anchors.options = {
      visible: 'hover',
      placement: 'left',
      // icon: 'ℬ'
      icon: '❡'
    };
    anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
  });
</script>
<style>
  /* place left on bigger screen */
  @media all and (min-width: 800px) {
    .anchorjs-link {
      position: absolute;
      left: -0.75em;
      font-size: 1.1em;
      margin-top: -0.1em;
    }
  }
</style>

<!-- anchorjs end -->



		<!-- Footer (contains ThemeColor、viewer) -->
		<!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          

          

          

          

          

          

          

          

        </ul>
        <p class="copyright text-muted">
          Copyright &copy;
          0nlyuAar0n
          2021
          <br>
          Theme by
          <a target="_blank" rel="noopener" href="https://v-vincen.life/">Live My Life</a>
          <span style="display: inline-block; margin: 0 5px;">
            <i class="fa fa-heart"></i>
          </span>
          // <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=V-Vincen&repo=V-Vincen.github.io&type=star&count=true"></iframe>
        </p>
      </div>
    </div>
  </div>
</footer>

<a id="rocket" href="#top" class=""></a>


  <!-- jQuery -->
  <script type="text/javascript" src="/js/jquery.min.js"></script>
  <!-- Bootstrap Core JavaScript -->
  <script type="text/javascript" src="/js/bootstrap.min.js"></script>
  <!-- Custom Theme JavaScript -->
  <script type="text/javascript" src="/js/hux-blog.min.js"></script>
  <!-- catalog -->
  <script async="true" type="text/javascript" src="/js/catalog.js"></script>
  <!-- totop(rocket) -->
  <script async="true" type="text/javascript" src="/js/totop.js"></script>

  
    <!-- Busuanzi JavaScript -->
    <script async="async" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <!-- Scroll start -->
    <script async="async" type="text/javascript" src="/js/scroll.js"></script>
    <!-- Scroll end -->
  

  

  
    <!-- Mouseclick -->
    <script type="text/javascript" src="/js/mouseclick.js" content='The first step is as good as half over...,Le vent se lève, il faut tenter de vivre...,I shot an arrow into the air...,It fell to earth, I knew not where...,Some of us get dipped in flat...,some in satin, some in gloss...,But every once in a while you find someone who&#39;s iridescent...,and when you do, nothing will ever compare...,Bravery never goes out of fashion...' color='#9933CC,#339933,#66CCCC,#FF99CC,#CCCCFF,#6666CC,#663399,#66CC99,#FF0033'></script>
  

  
    <!-- ribbon -->
    <script type="text/javascript" src="/js/ribbonDynamic.js"></script>
  

  






  <!-- viewer start -->
  <!-- viewer start (Picture preview) -->
  
    <script async="async" type="text/javascript" src="/js/viewer/viewer.min.js"></script>
    <script async="async" type="text/javascript" src="/js/viewer/pic-viewer.js"></script>
  

  <!-- viewer end -->


<script>
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function (e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  }

  // fastClick.js
  async ("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function () {
    var $nav = document.querySelector("nav");
    if ($nav)
      FastClick.attach($nav);
    }
  )
</script>

<!-- Because of the native support for backtick-style fenced code blocks right within the Markdown is landed in Github Pages, From V1.6, There is no need for Highlight.js, so Huxblog drops it officially. -
https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0 - https://help.github.com/articles/creating-and-highlighting-code-blocks/ -->
<!-- <script> async ("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function () { hljs.initHighlightingOnLoad(); }) </script> <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet"> -->

<!-- jquery.tagcloud.js -->
<!-- <script> // only load tagcloud.js in tag.html if ($('#tag_cloud').length !== 0) { async ("http://yoursite-url/js/jquery.tagcloud.js", function () { $.fn.tagcloud.defaults = { // size: { start: 1, end: 1, unit: 'em' }, color: {
start: '#bbbbee', end: '#0085a1' } }; $('#tag_cloud a').tagcloud(); }) } </script> -->


		<!-- Search -->
		
		<div class="popup search-popup local-search-popup">
  <span class="popup-btn-close">
    ESC
  </span>
  <div class="container">
    <div class="row">
      <!-- <div class="col-md-9 col-md-offset-1"> -->
      <div class="col-lg-9 col-lg-offset-1 col-md-10 col-md-offset-1 local-search-content">

        <div class="local-search-header clearfix">

          <div class="local-search-input-wrapper">
            <span class="search-icon">
              <i class="fa fa-search fa-lg" style="margin: 25px 10px 25px 20px;"></i>
            </span>
            <input autocomplete="off" placeholder="SEARCH..." type="text" id="local-search-input">
          </div>
        </div>
        <div id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>


  
    <script src="/js/ziploader.js"></script>
  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    // monitor main search box;
    var onPopupClose = function (e) {
      $('.popup').fadeOut(300);
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $('.popup').fadeIn(300);
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }
    // get search zip version
    $.get('/searchVersion.json?t=' + (+new Date()), function (res) {
      if (localStorage.getItem('searchVersion') !== res) {
        localStorage.setItem('searchVersion', res);
        initSearchJson();
      }
    });

    function initSearchJson() {
      initLoad(['/search.flv'], {
        loadOptions: {
          success: function (obj) {
            localStorage.setItem('searchJson', obj['search.json'])
          },
          error: function (e) {
            return console.log(e)
          }
        },
        returnOptions: {
          'json': TYPE_TEXT
        },
        mimeOptions: {
          'json': 'application/json'
        }
      })
    }
    // search function;
    var searchFunc = function (search_id, content_id) {
      'use strict';
      isfetched = true;
      var datas = JSON.parse(localStorage.getItem('searchJson'));
      // console.log(search_id)
      var input = document.getElementById(search_id);
      var resultContent = document.getElementById(content_id);
      var inputEventFunction = function () {
        var searchText = input.value.trim().toLowerCase();
        var keywords = searchText.split(/[\s\-]+/);
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        var resultItems = [];
        if (searchText.length > 0) {
          // perform local searching
          datas.forEach(function (data) {
            var isMatch = false;
            var hitCount = 0;
            var searchTextCount = 0;
            var title = data.title
              ? data.title.trim()
              : '';
            var titleInLowerCase = title.toLowerCase();
            var content = data.content
              ? data.content.trim().replace(/<[^>]+>/g, "")
              : '';
            var contentInLowerCase = content.toLowerCase();
            var articleUrl = decodeURIComponent(data.url);

            var date = data.date;
            var dateTime = date.replace(/T/, " ").replace(/.000Z/, "");
            var imgUrl = data.header_img;
            


            var indexOfTitle = [];
            var indexOfContent = [];
            // only match articles with not empty titles
            keywords.forEach(function (keyword) {
              function getIndexByWord(word, text, caseSensitive) {
                var wordLen = word.length;
                if (wordLen === 0) {
                  return [];
                }
                var startPosition = 0,
                  position = [],
                  index = [];
                if (!caseSensitive) {
                  text = text.toLowerCase();
                  word = word.toLowerCase();
                }
                while ((position = text.indexOf(word, startPosition)) > -1) {
                  index.push({position: position, word: word});
                  startPosition = position + wordLen;
                }
                return index;
              }
              indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
              indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
            });
            if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
              isMatch = true;
              hitCount = indexOfTitle.length + indexOfContent.length;
            }
            // show search results
            if (isMatch) {
              // sort index by position of keyword
              [indexOfTitle, indexOfContent].forEach(function (index) {
                index.sort(function (itemLeft, itemRight) {
                  if (itemRight.position !== itemLeft.position) {
                    return itemRight.position - itemLeft.position;
                  } else {
                    return itemLeft.word.length - itemRight.word.length;
                  }
                });
              });
              // merge hits into slices
              function mergeIntoSlice(text, start, end, index) {
                var item = index[index.length - 1];
                var position = item.position;
                var word = item.word;
                var hits = [];
                var searchTextCountInSlice = 0;
                while (position + word.length <= end && index.length != 0) {
                  if (word === searchText) {
                    searchTextCountInSlice++;
                  }
                  hits.push({position: position, length: word.length});
                  var wordEnd = position + word.length;
                  // move to next position of hit
                  index.pop();
                  while (index.length != 0) {
                    item = index[index.length - 1];
                    position = item.position;
                    word = item.word;
                    if (wordEnd > position) {
                      index.pop();
                    } else {
                      break;
                    }
                  }
                }
                searchTextCount += searchTextCountInSlice;
                return {hits: hits, start: start, end: end, searchTextCount: searchTextCountInSlice};
              }
              var slicesOfTitle = [];
              if (indexOfTitle.length != 0) {
                slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
              }
              var slicesOfContent = [];
              while (indexOfContent.length != 0) {
                var item = indexOfContent[indexOfContent.length - 1];
                var position = item.position;
                var word = item.word;
                // cut out 100 characters
                var start = position - 20;
                var end = position + 80;
                if (start < 0) {
                  start = 0;
                }
                if (end < position + word.length) {
                  end = position + word.length;
                }
                if (end > content.length) {
                  end = content.length;
                }
                slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
              }
              // sort slices in content by search text's count and hits' count
              slicesOfContent.sort(function (sliceLeft, sliceRight) {
                if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                  return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                  return sliceRight.hits.length - sliceLeft.hits.length;
                } else {
                  return sliceLeft.start - sliceRight.start;
                }
              });
              // select top N slices in content
              var upperBound = parseInt('1');
              if (upperBound >= 0) {
                slicesOfContent = slicesOfContent.slice(0, upperBound);
              }
              // highlight title and content
              function highlightKeyword(text, slice) {
                var result = '';
                var prevEnd = slice.start;
                slice.hits.forEach(function (hit) {
                  result += text.substring(prevEnd, hit.position);
                  var end = hit.position + hit.length;
                  result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                  prevEnd = end;
                });
                result += text.substring(prevEnd, slice.end);
                return result;
              }
              var resultItem = '';

              // if (slicesOfTitle.length != 0) {   resultItem += "<li><a target='_blank' href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>"; } else {   resultItem += "<li><a target='_blank' href='" +
              // articleUrl + "' class='search-result-title'>" + title + "</a>"; } slicesOfContent.forEach(function (slice) {   resultItem += "<a target='_blank' href='" + articleUrl + "'><p class=\"search-result\">" + highlightKeyword(content, slice) +
              // "...</p></a>"; }); resultItem += "</li>";

              if (slicesOfTitle.length != 0) {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</div><time class='search-result-date'>" + dateTime + "</time>";
              } else {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + title + "</div><time class='search-result-date'>" + dateTime + "</time>";
              }
              slicesOfContent.forEach(function (slice) {
                resultItem += "<p class=\"search-result-content\">" + highlightKeyword(content, slice) + "...</p>";
              });
              resultItem += "</div><div class='search-result-right'><img class='media-image' src='" + imgUrl + "' width='64px' height='48px'></img></div></a>";

              resultItems.push({item: resultItem, searchTextCount: searchTextCount, hitCount: hitCount, id: resultItems.length});
            }
          })
        };

        if (keywords.length === 1 && keywords[0] === "") {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else if (resultItems.length === 0) {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else {
          resultItems.sort(function (resultLeft, resultRight) {
            if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
              return resultRight.searchTextCount - resultLeft.searchTextCount;
            } else if (resultLeft.hitCount !== resultRight.hitCount) {
              return resultRight.hitCount - resultLeft.hitCount;
            } else {
              return resultRight.id - resultLeft.id;
            }
          });
          var searchResultList = '<div class=\"search-result-list\">';
          resultItems.forEach(function (result) {
            searchResultList += result.item;
          })
          searchResultList += "</div>";
          resultContent.innerHTML = searchResultList;
        }
      }
      if ('auto' === 'auto') {
        input.addEventListener('input', inputEventFunction);
      } else {
        $('.search-icon').click(inputEventFunction);
        input.addEventListener('keypress', function (event) {
          if (event.keyCode === 13) {
            inputEventFunction();
          }
        });
      }
      // remove loading animation
      $('body').css('overflow', '');
      proceedsearch();
    }
    // handle and trigger popup window;
    $('.popup-trigger').click(function (e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc('local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });
    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function (e) {
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 && $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

    document.addEventListener('mouseup', (e) => {
      var _con = document.querySelector(".local-search-content");
      if (_con) {
        if (!_con.contains(e.target)) {
          onPopupClose();
        }
      }
    });
  </script>


		
	<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
